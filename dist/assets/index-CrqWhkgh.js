(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))o(r);new MutationObserver(r=>{for(const i of r)if(i.type==="childList")for(const s of i.addedNodes)s.tagName==="LINK"&&s.rel==="modulepreload"&&o(s)}).observe(document,{childList:!0,subtree:!0});function n(r){const i={};return r.integrity&&(i.integrity=r.integrity),r.referrerPolicy&&(i.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?i.credentials="include":r.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function o(r){if(r.ep)return;r.ep=!0;const i=n(r);fetch(r.href,i)}})();const Pt="modulepreload",Nt=function(e){return"/Nous/"+e},Ae={},Y=function(t,n,o){let r=Promise.resolve();if(n&&n.length>0){let l=function(p){return Promise.all(p.map(v=>Promise.resolve(v).then(h=>({status:"fulfilled",value:h}),h=>({status:"rejected",reason:h}))))};document.getElementsByTagName("link");const s=document.querySelector("meta[property=csp-nonce]"),u=s?.nonce||s?.getAttribute("nonce");r=l(n.map(p=>{if(p=Nt(p),p in Ae)return;Ae[p]=!0;const v=p.endsWith(".css"),h=v?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${p}"]${h}`))return;const d=document.createElement("link");if(d.rel=v?"stylesheet":Pt,v||(d.as="script"),d.crossOrigin="",d.href=p,u&&d.setAttribute("nonce",u),document.head.appendChild(d),v)return new Promise((g,y)=>{d.addEventListener("load",g),d.addEventListener("error",()=>y(new Error(`Unable to preload CSS for ${p}`)))})}))}function i(s){const u=new Event("vite:preloadError",{cancelable:!0});if(u.payload=s,window.dispatchEvent(u),!u.defaultPrevented)throw s}return r.then(s=>{for(const u of s||[])u.status==="rejected"&&i(u.reason);return t().catch(i)})};let le,Re,xe;const w=(()=>{let e=[],t=null,n=[],o={currentScreen:"welcome",lives:0,score:0,roundsToWin:3,roundsWon:0,roundNumber:1,roundScore:0,thread:0,audacity:0,difficultyLevel:1,correctAnswersThisDifficulty:0,answeredQuestionIds:new Set,completedFateCardIds:new Set,activeRoundEffects:[],currentFateCard:null,pendingFateCard:null,activeFateCard:null,currentQuestion:null,currentAnswers:[],notWrongCount:0,currentCategory:"Mind, Past",roundAnswerTally:{A:0,B:0,C:0},traits:{X:0,Y:0,Z:0},activePowerUps:[],answeredThisRound:[],fateCardDeck:[],questionDeck:[]};typeof window<"u"&&(le=window.CLASS_SCORES,Re=window.CLASS_TRAIT_BASE,xe=window.TRAIT_LOADINGS);const r=async()=>{try{const[{default:a},f]=await Promise.all([Y(()=>Promise.resolve().then(()=>Fi),void 0),Y(()=>import("./questions-BAxrD2KR.js"),[]).catch(()=>Y(()=>import("./questions-BmAxWREq.js"),[])).catch(()=>Y(()=>import("./questionDeck-CIvgfmgs.js"),[]))]),b=f.default??f,E=Array.isArray(b.questions)?b.questions:b;n=[...a],e=[...E],o.fateCardDeck=[...a],o.questionDeck=[...E],typeof QuestionEngine<"u"?(QuestionEngine.setDefaultDeck(e),t=new QuestionEngine(e)):t={nextQuestion:()=>e[0]||null,resolve:()=>({})}}catch(a){console.error("[LOAD DATA]",a),n=[],e=[{questionId:"T1",title:"Q1",text:"T1",answers:[{text:"A",answerClass:"Typical",explanation:""},{text:"B",answerClass:"Revelatory",explanation:""},{text:"C",answerClass:"Wrong",explanation:""}]}],o.fateCardDeck=[],o.questionDeck=[...e],typeof QuestionEngine<"u"?(QuestionEngine.setDefaultDeck(e),t=new QuestionEngine(e)):t={nextQuestion:()=>e[0]||null,resolve:()=>({})}}},i=(a=1)=>{o={...o,lives:a+1,score:0,roundsWon:0,roundNumber:1,roundScore:0,thread:4,audacity:0,difficultyLevel:1,correctAnswersThisDifficulty:0,answeredQuestionIds:new Set,completedFateCardIds:new Set,activeRoundEffects:[],currentFateCard:null,pendingFateCard:null,activeFateCard:null,currentQuestion:null,currentAnswers:[],notWrongCount:0,currentCategory:"Mind, Past",roundAnswerTally:{A:0,B:0,C:0},traits:{X:0,Y:0,Z:0},activePowerUps:[],answeredThisRound:[],fateCardDeck:o.fateCardDeck,questionDeck:o.questionDeck}},s=()=>{o.roundNumber++,o.roundScore=0;const a=o.roundsToWin-o.roundsWon;o.thread=a+1,o.notWrongCount=0,o.activeRoundEffects=[],o.roundAnswerTally={A:0,B:0,C:0},o.activePowerUps=[],o.answeredThisRound=[],o.currentFateCard=null,o.currentCategory="Mind, Past",o.currentAnswers=[],o.activeFateCard=o.pendingFateCard,o.activeFateCard&&(o.activeFateCard.id==="DYN005"||o.activeFateCard.id==="DYN004")&&o.activeFateCard.id==="DYN005"&&o.thread++,o.pendingFateCard=null},u=(a="lose")=>{switch(C(),a){case"win":o.roundsWon++,o.score+=o.roundScore;break;case"lose":o.lives--;break;case"escape":o.score+=o.roundScore,o.roundScore=0;break}},l=()=>o.thread>0?(o.thread--,!0):!1,p=()=>{o.thread--},v=()=>(u("escape"),!0),h=()=>{const a=["Mind, Present","Body, Future","Soul, Past"];o.currentCategory=a[Math.floor(Math.random()*a.length)]},d=()=>{o.difficultyLevel<3&&(o.difficultyLevel++,o.correctAnswersThisDifficulty=0,console.log(`[DIFFICULTY]: Advanced to level ${o.difficultyLevel}`))},g=()=>{if(o.pendingFateCard)return console.log("[FATE]: A fate is already pending."),null;const a=n;if(a.length===0)return console.warn("[FATE]: Deck is empty"),null;const f=a[Math.floor(Math.random()*a.length)];return o.pendingFateCard=f,f},y=a=>{o.currentFateCard=a},A=()=>o.currentFateCard,x=a=>{const f=o.currentFateCard;if(!f)return null;const b=f.choices[a];if(!b)return null;const E=D({...b.effect},f.title);return o.completedFateCardIds.add(f.id),o.currentFateCard=null,E},D=(a,f="")=>{if(!a)return null;switch(a.type){case"IMMEDIATE_SCORE":o.score+=a.value;break;case"SCORE":o.roundScore+=a.value;break;case"POWER_UP":o.activePowerUps.push(a.power);break;default:o.activeRoundEffects.push({...a,cardTitle:f,count:0});break}return a.flavorText||null},C=()=>{o.activeRoundEffects.forEach(a=>{switch(a.type){case"ROUND_PREDICTION":{const f=o.roundAnswerTally,b=Object.entries(f).sort((E,R)=>R[1]-E[1])[0];b&&b[1]>0&&b[0]===a.prediction&&a.reward&&(a.reward.type==="DOUBLE_ROUND_SCORE"?o.roundScore*=2:a.reward.type==="SCORE"&&(o.score+=a.reward.value));break}case"ROUND_MODIFIER":a.reward&&o.thread>0&&a.reward.type==="SCORE"&&(o.score+=a.reward.value);break;case"TALLY_ANSWERS":a.count&&a.count>0&&(o.score+=a.count);break}}),o.activeRoundEffects=[],o.roundAnswerTally={A:0,B:0,C:0}},k=a=>{for(let f=a.length-1;f>0;f--){const b=Math.floor(Math.random()*(f+1));[a[f],a[b]]=[a[b],a[f]]}};return{loadData:r,initializeGame:i,startNewRound:s,endRound:u,spendThreadToWeave:l,pullThread:p,cutThread:v,shuffleNextCategory:h,getState:()=>({...o}),drawFateCard:g,applyFateCardEffect:D,setCurrentFateCard:y,getCurrentFateCard:A,chooseFateOption:x,getNextQuestion:()=>{if(!t)return console.warn("[QUESTION]: Engine unavailable"),null;const a=t.nextQuestion();if(!a)return console.warn("[QUESTION]: Deck exhausted"),null;if(o.currentQuestion=a,o.currentAnswers=a.answers.slice(),k(o.currentAnswers),o.activePowerUps.includes("REMOVE_WRONG_ANSWER")){const f=o.currentAnswers.findIndex(b=>b.answerClass==="Wrong");f!==-1&&o.currentAnswers.splice(f,1),o.activePowerUps=o.activePowerUps.filter(b=>b!=="REMOVE_WRONG_ANSWER")}return{...o.currentQuestion,answers:o.currentAnswers}},evaluateAnswer:a=>{o.roundAnswerTally[a]=(o.roundAnswerTally[a]||0)+1,o.activeRoundEffects.forEach(O=>{O.type==="APPLY_WAGER"&&`answer-${a.toLowerCase()}`===O.target?O.reward.type==="SCORE"&&(o.score+=O.reward.value):O.type==="TALLY_ANSWERS"&&a.toUpperCase()===O.target.toUpperCase()&&(O.count=(O.count||0)+1)});const f=o.currentQuestion;if(!f)return console.warn("[EVAL]: No current question"),null;o.answeredQuestionIds.add(f.questionId);const E={A:0,B:1,C:2}[a]??0,R=o.currentAnswers[E];t&&t.resolve(f.questionId,E,{points:0,thread:0,traits:{}});const N=R.answerClass;let F=N!=="Wrong",ue=le[N]?.thread??0,$e=le[N]?.points??0;F&&(o.notWrongCount++,o.correctAnswersThisDifficulty++);const xt=Re[N],Te=xe[f.questionId]||{},Ot=Te.axisWeight||{},Ie=Te.overrides?.[N]||{};if(["X","Y","Z"].forEach(O=>{const Dt=O in Ie?Ie[O]:xt[O]*(Ot[O]??1);o.traits[O]=Math.max(-9,Math.min(9,(o.traits[O]||0)+Dt))}),o.activeFateCard)switch(o.activeFateCard.id){case"DYN001":F||(ue-=1);break;case"DYN002":F&&N==="Revelatory"&&($e+=1);break}return o.thread+=ue,o.roundScore+=$e,o.correctAnswersThisDifficulty>3&&d(),o.notWrongCount>=3&&(o.roundPassed=!0),{correct:F,question:f.text,answer:R.text,explanation:R.explanation,outcomeText:F?"The thread holds.":`The thread frays by ${Math.abs(ue)}`}},incrementAudacity:()=>{o.audacity++},loseRoundPoints:()=>{o.roundScore=0},hasWonGame:()=>o.roundsWon>=o.roundsToWin,isOutOfLives:()=>o.lives<=0,saveGame:()=>{try{return localStorage.setItem("nous-save",JSON.stringify(o)),!0}catch(a){return console.error("[SAVE]",a),!1}},loadGame:async()=>{try{const a=localStorage.getItem("nous-save");if(!a)return!1;const f=JSON.parse(a),{validateGameState:b}=await Y(async()=>{const{validateGameState:E}=await import("./validator-D-8TOk70.js");return{validateGameState:E}},[]);try{b(f)}catch(E){return console.error("[LOAD VALIDATION]",E),!1}return o={...o,...f},!0}catch(a){return console.error("[LOAD]",a),!1}},recordAnswer:(a,f)=>{o.answeredThisRound.push({qid:a,letter:f})},resetRound:()=>{o.answeredThisRound=[],o.activeRoundEffects=[]},applyFateResults:(a={})=>{if(!a)return;const{scoreDelta:f=0,roundScoreDelta:b=0,roundScoreMultiplier:E=1}=a;o.score+=f,o.roundScore+=b,o.roundScore*=E}}})();typeof window<"u"&&(window.State=w);const Ft=new Set(["start-game","go-rules","go-options","back-to-welcome","save-and-quit","tempt-fate","next-round","end-round","double-points","start-question","answer-a","answer-b","answer-c","challenge-result","accept-result","return-to-lobby","restart-game","save-reading","quit-game","welcome-up","welcome-down","welcome-select","participants-up","participants-confirm","participants-down","fate-a","fate-b","fate-c"]),tt={welcome:[{label:"Up",action:"welcome-up"},{label:"Select",action:"welcome-select"},{label:"Down",action:"welcome-down"}],rules:[{label:"Back",action:"back-to-welcome"},null,null],options:[{label:"Back",action:"back-to-welcome"},null,null],participants:[{label:"More",action:"participants-up"},{label:"Confirm",action:"participants-confirm"},{label:"Less",action:"participants-down"}],"game-lobby":[{label:"Turn Back",action:"save-and-quit"},{label:"Tempt Fate",action:"tempt-fate"},{label:"Press On",action:"next-round"}],"round-lobby":[{label:"Cut the Thread",action:"end-round"},{label:"Weave it to Fate",action:"double-points"},{label:"Pull the Thread",action:"start-question"}],question:[{label:"Choose A",action:"answer-a"},{label:"Choose B",action:"answer-b"},{label:"Choose C",action:"answer-c"}],"fate-card":[{label:"Choose A",action:"fate-a"},{label:"Choose B",action:"fate-b"},{label:"Choose C",action:"fate-c"}],result:[{label:"Disagree",action:"challenge-result"},{label:"Outcome",action:"",disabled:!0},{label:"Accept",action:"accept-result"}],failure:[{label:"[Logo]",action:"",disabled:!0},{label:"Return to Lobby",action:"return-to-lobby"},{label:"[Logo]",action:"",disabled:!0}],"final-reading":[{label:"Restart",action:"restart-game"},{label:"Save Reading",action:"save-reading"},{label:"Quit",action:"quit-game"}]};function Lt(e){for(const t in e)e[t].forEach((n,o)=>{n&&n.action&&!Ft.has(n.action)&&console.warn(`⚠️ Invalid action '${n.action}' on button ${o+1} for screen '${t}'`)})}Lt(tt);const _=(()=>{const e=document.getElementById("app-container"),t=document.getElementById("controller"),n=document.getElementById("last-change"),o=document.getElementById("aria-status"),r={btn1:document.getElementById("btn-1"),btn2:document.getElementById("btn-2"),btn3:document.getElementById("btn-3")};r.btn1.querySelector(".button-label"),r.btn2.querySelector(".button-label"),r.btn3.querySelector(".button-label");const i=document.querySelectorAll(".game-screen"),s=()=>{},u=Array.from(document.querySelectorAll("#welcome-options li"));let l=0;const p=()=>{u.forEach((a,f)=>{a.classList.toggle("selected",f===l)}),o&&(o.textContent=h())},v=a=>{a==="up"?l=(l-1+u.length)%u.length:a==="down"&&(l=(l+1)%u.length),p()},h=()=>{const a=u[l];return a?a.textContent.replace(/^\s*[^A-Za-z0-9]*/,"").trim():""},d=a=>{e.classList.add("is-transitioning"),setTimeout(()=>{i.forEach(b=>{b.classList.remove("is-active"),b.setAttribute("aria-hidden","true")});const f=document.querySelector(`[data-screen="${a}"]`);f&&(f.classList.add("is-active"),f.setAttribute("aria-hidden","false")),e.setAttribute("data-game-state",a),t.setAttribute("data-controller-state",a),n&&(n.textContent=`Last state: ${a}`),o&&(o.textContent=a.replace("-"," ")),g(a),a==="welcome"&&p(),e.classList.remove("is-transitioning")},700)},g=a=>{const f=tt[a]||[];["btn1","btn2","btn3"].forEach((b,E)=>{const R=r[b],N=R.querySelector(".button-label"),F=f[E];F&&N?(N.innerText=F.label,R.disabled=!!F.disabled,R.setAttribute("data-action",F.action||"")):N&&(N.innerText="",R.disabled=!0,R.removeAttribute("data-action"))})},y=a=>{["btn1","btn2","btn3"].forEach((f,b)=>{const E=r[f],R=a[b]||"";E.querySelector(".button-label").innerText=R||" ",E.disabled=R==="",E.classList.toggle("hidden",R==="")})},A=document.getElementById("participant-count-display"),x=document.getElementById("participant-flavor");let D=1;const C=()=>{A.textContent=D},k=()=>{D=1,x.hidden=!0,C(),d("participants")},$=a=>{D=Math.min(20,Math.max(1,D+a)),C()},L=()=>D,W=()=>{const a=D;return x.textContent=`Strange... it looks like there are ${a+1} of you here. Ah well.`,x.hidden=!1,a},q=a=>{if("lives"in a&&(document.getElementById("lives-display").textContent=a.lives),"roundsToWin"in a&&"roundsWon"in a){const f=a.roundsToWin-a.roundsWon;document.getElementById("rounds-display").textContent=f}if("score"in a&&(document.getElementById("score-display").textContent=a.score),"thread"in a&&(document.getElementById("thread-display").textContent=a.thread),"roundScore"in a&&(document.getElementById("round-score").textContent=a.roundScore),"roundNumber"in a&&(document.getElementById("round-number-display").textContent=a.roundNumber),"currentCategory"in a&&(document.getElementById("category-hint").textContent=a.currentCategory),"activeRoundEffects"in a){const f=document.querySelector("#divinations-display p"),b=a.activeRoundEffects.map(E=>E.cardTitle).filter(Boolean);f.textContent=b.length?b.join(", "):"[None]"}},V=a=>{document.getElementById("question-title").textContent=a.title||"",document.getElementById("question-text").textContent=a.text||"",document.getElementById("answer-a").textContent=a.choices?.A||"",document.getElementById("answer-b").textContent=a.choices?.B||"",document.getElementById("answer-c").textContent=a.choices?.C||""},ce=a=>{document.querySelector("#fate-card-title").textContent=a.title,document.querySelector("#fate-card-text").textContent=a.text};return{initialize:s,updateScreen:d,configureButtons:g,updateDisplayValues:q,showQuestion:V,setButtonLabels:y,showResult:a=>{document.getElementById("result-header").textContent=a.correct?"Correct":"Incorrect",document.getElementById("result-question").textContent=a.question,document.getElementById("result-chosen-answer").textContent=a.answer,document.getElementById("result-explanation").textContent=a.explanation,document.getElementById("result-outcome-message").textContent=a.outcomeText},showFailure:a=>{document.getElementById("lost-points-display").textContent=a},showFate:a=>{ce(a)},showFateCard:ce,showFateChoices:(a=[])=>{const f=document.querySelectorAll("#controller button");for(;a.length<3;)a.push("");f.forEach((b,E)=>{const R=a[E]||"";b.querySelector(".button-label").textContent=R||" ",b.disabled=!R,b.classList.toggle("hidden",!R)})},showFateResult:a=>{a&&(alert(a),console.log(`[FATE RESULT]: ${a}`))},showParticipantEntry:k,adjustParticipantCount:$,getParticipantCount:L,confirmParticipants:W,moveWelcomeSelection:v,getWelcomeSelection:h}})();typeof window<"u"&&(window.UI=_);const nt={Typical:{points:2,thread:0},Revelatory:{points:1,thread:1},Wrong:{points:0,thread:-1}},Ut={Typical:{X:1,Y:0,Z:-1},Revelatory:{X:0,Y:2,Z:1},Wrong:{X:-1,Y:-1,Z:0}},ot={Typical:{X:-1,Y:-1,Z:-1},Revelatory:{X:2,Y:3,Z:2},Wrong:{X:-2,Y:-2,Z:-2}};typeof window<"u"&&(window.CLASS_SCORES=nt,window.TRAIT_MAP=Ut,window.CLASS_TRAIT_BASE=ot);const rt={101:{axisWeight:{Z:0}},103:{axisWeight:{Z:0}},104:{axisWeight:{Z:.5}},105:{axisWeight:{Z:0}},106:{axisWeight:{Z:0}},107:{axisWeight:{Z:.5}},108:{axisWeight:{Z:1.5},overrides:{Typical:{Z:-3},Revelatory:{X:-1,Y:0,Z:2},Wrong:{X:-2,Y:1,Z:1}}},109:{axisWeight:{Z:1.5}},201:{axisWeight:{Z:0}},202:{axisWeight:{Z:1.5}},203:{axisWeight:{Z:0}},204:{axisWeight:{Z:0}},205:{axisWeight:{X:.5,Y:.7,Z:1.2},overrides:{Typical:{X:1,Y:-2,Z:-2},Revelatory:{X:-2,Y:4,Z:2},Wrong:{X:-2,Y:1,Z:-3}}},206:{axisWeight:{Z:1}},207:{axisWeight:{Z:1.5}},208:{},209:{axisWeight:{Z:0}}};typeof window<"u"&&(window.TRAIT_LOADINGS=rt);let Wt=[];function Oe(e){for(let t=e.length-1;t>0;t--){const n=Math.floor(Math.random()*(t+1));[e[t],e[n]]=[e[n],e[t]]}return e}let Mt=class{constructor(t=Wt){this.tier="Tier1",this.answered=new Set,this.drawnThisTier=0,this.deck=Array.isArray(t)?t.filter(n=>Array.isArray(n.answers)&&n.answers.length>=3):[],this.pools={Tier1:this.deck.filter(n=>n.difficultyTier==="Tier1"),Tier2:this.deck.filter(n=>n.difficultyTier==="Tier2"),Tier3:this.deck.filter(n=>n.difficultyTier==="Tier3")}}nextQuestion(){const t=this.tier==="Tier3"?["Tier3","Tier2","Tier1"]:this.tier==="Tier2"?["Tier2","Tier1"]:["Tier1"];for(const n of t){const o=this.pools[n].filter(r=>!this.answered.has(r.questionId));if(o.length){const r=Oe(o)[0];return this.randomizeAnswers(r),r}}return null}randomizeAnswers(t){t.answers=Oe([...t.answers])}resolve(t,n,o){const i=this.deck.find(d=>d.questionId===t).answers[n],{points:s,thread:u}=nt[i.answerClass];o.points+=s,o.thread+=u;const l=ot[i.answerClass],p=rt[t]||{},v=p.axisWeight||{},h=p.overrides?.[i.answerClass]||{};return["X","Y","Z"].forEach(d=>{const g=d in h?h[d]:l[d]*(v[d]??1);o.traits[d]=Math.max(-9,Math.min(9,(o.traits[d]||0)+g))}),this.answered.add(t),this.drawnThisTier++,(this.drawnThisTier>=4||!this.pools[this.tier].some(d=>!this.answered.has(d.questionId)))&&this.tier!=="Tier3"&&(this.drawnThisTier=0,this.tier=this.tier==="Tier1"?"Tier2":"Tier3"),i}};typeof window<"u"&&(window.QuestionEngine=Mt);function c(e,t,n){function o(u,l){var p;Object.defineProperty(u,"_zod",{value:u._zod??{},enumerable:!1}),(p=u._zod).traits??(p.traits=new Set),u._zod.traits.add(e),t(u,l);for(const v in s.prototype)v in u||Object.defineProperty(u,v,{value:s.prototype[v].bind(u)});u._zod.constr=s,u._zod.def=l}const r=n?.Parent??Object;class i extends r{}Object.defineProperty(i,"name",{value:e});function s(u){var l;const p=n?.Parent?new i:this;o(p,u),(l=p._zod).deferred??(l.deferred=[]);for(const v of p._zod.deferred)v();return p}return Object.defineProperty(s,"init",{value:o}),Object.defineProperty(s,Symbol.hasInstance,{value:u=>n?.Parent&&u instanceof n.Parent?!0:u?._zod?.traits?.has(e)}),Object.defineProperty(s,"name",{value:e}),s}class K extends Error{constructor(){super("Encountered Promise during synchronous parse. Use .parseAsync() instead.")}}const it={};function M(e){return it}function jt(e){const t=Object.values(e).filter(o=>typeof o=="number");return Object.entries(e).filter(([o,r])=>t.indexOf(+o)===-1).map(([o,r])=>r)}function Bt(e,t){return typeof t=="bigint"?t.toString():t}function st(e){return{get value(){{const t=e();return Object.defineProperty(this,"value",{value:t}),t}}}}function be(e){return e==null}function ye(e){const t=e.startsWith("^")?1:0,n=e.endsWith("$")?e.length-1:e.length;return e.slice(t,n)}function qt(e,t){const n=(e.toString().split(".")[1]||"").length,o=(t.toString().split(".")[1]||"").length,r=n>o?n:o,i=Number.parseInt(e.toFixed(r).replace(".","")),s=Number.parseInt(t.toFixed(r).replace(".",""));return i%s/10**r}function z(e,t,n){Object.defineProperty(e,t,{get(){{const o=n();return e[t]=o,o}},set(o){Object.defineProperty(e,t,{value:o})},configurable:!0})}function ke(e,t,n){Object.defineProperty(e,t,{value:n,writable:!0,enumerable:!0,configurable:!0})}function G(e){return JSON.stringify(e)}const at=Error.captureStackTrace?Error.captureStackTrace:(...e)=>{};function he(e){return typeof e=="object"&&e!==null&&!Array.isArray(e)}const Vt=st(()=>{if(typeof navigator<"u"&&navigator?.userAgent?.includes("Cloudflare"))return!1;try{const e=Function;return new e(""),!0}catch{return!1}});function fe(e){if(he(e)===!1)return!1;const t=e.constructor;if(t===void 0)return!0;const n=t.prototype;return!(he(n)===!1||Object.prototype.hasOwnProperty.call(n,"isPrototypeOf")===!1)}const Yt=new Set(["string","number","symbol"]);function ie(e){return e.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}function B(e,t,n){const o=new e._zod.constr(t??e._zod.def);return(!t||n?.parent)&&(o._zod.parent=e),o}function m(e){const t=e;if(!t)return{};if(typeof t=="string")return{error:()=>t};if(t?.message!==void 0){if(t?.error!==void 0)throw new Error("Cannot specify both `message` and `error` params");t.error=t.message}return delete t.message,typeof t.error=="string"?{...t,error:()=>t.error}:t}function Gt(e){return Object.keys(e).filter(t=>e[t]._zod.optin==="optional"&&e[t]._zod.optout==="optional")}const Qt={safeint:[Number.MIN_SAFE_INTEGER,Number.MAX_SAFE_INTEGER],int32:[-2147483648,2147483647],uint32:[0,4294967295],float32:[-34028234663852886e22,34028234663852886e22],float64:[-Number.MAX_VALUE,Number.MAX_VALUE]};function Xt(e,t){const n={},o=e._zod.def;for(const r in t){if(!(r in o.shape))throw new Error(`Unrecognized key: "${r}"`);t[r]&&(n[r]=o.shape[r])}return B(e,{...e._zod.def,shape:n,checks:[]})}function Kt(e,t){const n={...e._zod.def.shape},o=e._zod.def;for(const r in t){if(!(r in o.shape))throw new Error(`Unrecognized key: "${r}"`);t[r]&&delete n[r]}return B(e,{...e._zod.def,shape:n,checks:[]})}function Jt(e,t){if(!fe(t))throw new Error("Invalid input to extend: expected a plain object");const n={...e._zod.def,get shape(){const o={...e._zod.def.shape,...t};return ke(this,"shape",o),o},checks:[]};return B(e,n)}function Ht(e,t){return B(e,{...e._zod.def,get shape(){const n={...e._zod.def.shape,...t._zod.def.shape};return ke(this,"shape",n),n},catchall:t._zod.def.catchall,checks:[]})}function en(e,t,n){const o=t._zod.def.shape,r={...o};if(n)for(const i in n){if(!(i in o))throw new Error(`Unrecognized key: "${i}"`);n[i]&&(r[i]=e?new e({type:"optional",innerType:o[i]}):o[i])}else for(const i in o)r[i]=e?new e({type:"optional",innerType:o[i]}):o[i];return B(t,{...t._zod.def,shape:r,checks:[]})}function tn(e,t,n){const o=t._zod.def.shape,r={...o};if(n)for(const i in n){if(!(i in r))throw new Error(`Unrecognized key: "${i}"`);n[i]&&(r[i]=new e({type:"nonoptional",innerType:o[i]}))}else for(const i in o)r[i]=new e({type:"nonoptional",innerType:o[i]});return B(t,{...t._zod.def,shape:r,checks:[]})}function Q(e,t=0){for(let n=t;n<e.issues.length;n++)if(e.issues[n]?.continue!==!0)return!0;return!1}function Ee(e,t){return t.map(n=>{var o;return(o=n).path??(o.path=[]),n.path.unshift(e),n})}function ee(e){return typeof e=="string"?e:e?.message}function j(e,t,n){const o={...e,path:e.path??[]};if(!e.message){const r=ee(e.inst?._zod.def?.error?.(e))??ee(t?.error?.(e))??ee(n.customError?.(e))??ee(n.localeError?.(e))??"Invalid input";o.message=r}return delete o.inst,delete o.continue,t?.reportInput||delete o.input,o}function ze(e){return Array.isArray(e)?"array":typeof e=="string"?"string":"unknown"}function J(...e){const[t,n,o]=e;return typeof t=="string"?{message:t,code:"custom",input:n,inst:o}:{...t}}const ct=(e,t)=>{e.name="$ZodError",Object.defineProperty(e,"_zod",{value:e._zod,enumerable:!1}),Object.defineProperty(e,"issues",{value:t,enumerable:!1}),Object.defineProperty(e,"message",{get(){return JSON.stringify(t,Bt,2)},enumerable:!0}),Object.defineProperty(e,"toString",{value:()=>e.message,enumerable:!1})},ut=c("$ZodError",ct),lt=c("$ZodError",ct,{Parent:Error});function nn(e,t=n=>n.message){const n={},o=[];for(const r of e.issues)r.path.length>0?(n[r.path[0]]=n[r.path[0]]||[],n[r.path[0]].push(t(r))):o.push(t(r));return{formErrors:o,fieldErrors:n}}function on(e,t){const n=t||function(i){return i.message},o={_errors:[]},r=i=>{for(const s of i.issues)if(s.code==="invalid_union"&&s.errors.length)s.errors.map(u=>r({issues:u}));else if(s.code==="invalid_key")r({issues:s.issues});else if(s.code==="invalid_element")r({issues:s.issues});else if(s.path.length===0)o._errors.push(n(s));else{let u=o,l=0;for(;l<s.path.length;){const p=s.path[l];l===s.path.length-1?(u[p]=u[p]||{_errors:[]},u[p]._errors.push(n(s))):u[p]=u[p]||{_errors:[]},u=u[p],l++}}};return r(e),o}const rn=e=>(t,n,o,r)=>{const i=o?Object.assign(o,{async:!1}):{async:!1},s=t._zod.run({value:n,issues:[]},i);if(s instanceof Promise)throw new K;if(s.issues.length){const u=new(r?.Err??e)(s.issues.map(l=>j(l,i,M())));throw at(u,r?.callee),u}return s.value},sn=e=>async(t,n,o,r)=>{const i=o?Object.assign(o,{async:!0}):{async:!0};let s=t._zod.run({value:n,issues:[]},i);if(s instanceof Promise&&(s=await s),s.issues.length){const u=new(r?.Err??e)(s.issues.map(l=>j(l,i,M())));throw at(u,r?.callee),u}return s.value},dt=e=>(t,n,o)=>{const r=o?{...o,async:!1}:{async:!1},i=t._zod.run({value:n,issues:[]},r);if(i instanceof Promise)throw new K;return i.issues.length?{success:!1,error:new(e??ut)(i.issues.map(s=>j(s,r,M())))}:{success:!0,data:i.value}},an=dt(lt),pt=e=>async(t,n,o)=>{const r=o?Object.assign(o,{async:!0}):{async:!0};let i=t._zod.run({value:n,issues:[]},r);return i instanceof Promise&&(i=await i),i.issues.length?{success:!1,error:new e(i.issues.map(s=>j(s,r,M())))}:{success:!0,data:i.value}},cn=pt(lt),un=/^[cC][^\s-]{8,}$/,ln=/^[0-9a-z]+$/,dn=/^[0-9A-HJKMNP-TV-Za-hjkmnp-tv-z]{26}$/,pn=/^[0-9a-vA-V]{20}$/,hn=/^[A-Za-z0-9]{27}$/,fn=/^[a-zA-Z0-9_-]{21}$/,mn=/^P(?:(\d+W)|(?!.*W)(?=\d|T\d)(\d+Y)?(\d+M)?(\d+D)?(T(?=\d)(\d+H)?(\d+M)?(\d+([.,]\d+)?S)?)?)$/,gn=/^([0-9a-fA-F]{8}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{12})$/,De=e=>e?new RegExp(`^([0-9a-fA-F]{8}-[0-9a-fA-F]{4}-${e}[0-9a-fA-F]{3}-[89abAB][0-9a-fA-F]{3}-[0-9a-fA-F]{12})$`):/^([0-9a-fA-F]{8}-[0-9a-fA-F]{4}-[1-8][0-9a-fA-F]{3}-[89abAB][0-9a-fA-F]{3}-[0-9a-fA-F]{12}|00000000-0000-0000-0000-000000000000)$/,_n=/^(?!\.)(?!.*\.\.)([A-Za-z0-9_'+\-\.]*)[A-Za-z0-9_+-]@([A-Za-z0-9][A-Za-z0-9\-]*\.)+[A-Za-z]{2,}$/,vn="^(\\p{Extended_Pictographic}|\\p{Emoji_Component})+$";function wn(){return new RegExp(vn,"u")}const bn=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])$/,yn=/^(([0-9a-fA-F]{1,4}:){7}[0-9a-fA-F]{1,4}|::|([0-9a-fA-F]{1,4})?::([0-9a-fA-F]{1,4}:?){0,6})$/,kn=/^((25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\/([0-9]|[1-2][0-9]|3[0-2])$/,En=/^(([0-9a-fA-F]{1,4}:){7}[0-9a-fA-F]{1,4}|::|([0-9a-fA-F]{1,4})?::([0-9a-fA-F]{1,4}:?){0,6})\/(12[0-8]|1[01][0-9]|[1-9]?[0-9])$/,zn=/^$|^(?:[0-9a-zA-Z+/]{4})*(?:(?:[0-9a-zA-Z+/]{2}==)|(?:[0-9a-zA-Z+/]{3}=))?$/,ht=/^[A-Za-z0-9_-]*$/,Sn=/^([a-zA-Z0-9-]+\.)*[a-zA-Z0-9-]+$/,Zn=/^\+(?:[0-9]){6,14}[0-9]$/,ft="(?:(?:\\d\\d[2468][048]|\\d\\d[13579][26]|\\d\\d0[48]|[02468][048]00|[13579][26]00)-02-29|\\d{4}-(?:(?:0[13578]|1[02])-(?:0[1-9]|[12]\\d|3[01])|(?:0[469]|11)-(?:0[1-9]|[12]\\d|30)|(?:02)-(?:0[1-9]|1\\d|2[0-8])))",Cn=new RegExp(`^${ft}$`);function mt(e){const t="(?:[01]\\d|2[0-3]):[0-5]\\d";return typeof e.precision=="number"?e.precision===-1?`${t}`:e.precision===0?`${t}:[0-5]\\d`:`${t}:[0-5]\\d\\.\\d{${e.precision}}`:`${t}(?::[0-5]\\d(?:\\.\\d+)?)?`}function $n(e){return new RegExp(`^${mt(e)}$`)}function Tn(e){const t=mt({precision:e.precision}),n=["Z"];e.local&&n.push(""),e.offset&&n.push("([+-]\\d{2}:\\d{2})");const o=`${t}(?:${n.join("|")})`;return new RegExp(`^${ft}T(?:${o})$`)}const In=e=>{const t=e?`[\\s\\S]{${e?.minimum??0},${e?.maximum??""}}`:"[\\s\\S]*";return new RegExp(`^${t}$`)},An=/^\d+$/,Rn=/^-?\d+(?:\.\d+)?/i,xn=/^[^A-Z]*$/,On=/^[^a-z]*$/,P=c("$ZodCheck",(e,t)=>{var n;e._zod??(e._zod={}),e._zod.def=t,(n=e._zod).onattach??(n.onattach=[])}),gt={number:"number",bigint:"bigint",object:"date"},_t=c("$ZodCheckLessThan",(e,t)=>{P.init(e,t);const n=gt[typeof t.value];e._zod.onattach.push(o=>{const r=o._zod.bag,i=(t.inclusive?r.maximum:r.exclusiveMaximum)??Number.POSITIVE_INFINITY;t.value<i&&(t.inclusive?r.maximum=t.value:r.exclusiveMaximum=t.value)}),e._zod.check=o=>{(t.inclusive?o.value<=t.value:o.value<t.value)||o.issues.push({origin:n,code:"too_big",maximum:t.value,input:o.value,inclusive:t.inclusive,inst:e,continue:!t.abort})}}),vt=c("$ZodCheckGreaterThan",(e,t)=>{P.init(e,t);const n=gt[typeof t.value];e._zod.onattach.push(o=>{const r=o._zod.bag,i=(t.inclusive?r.minimum:r.exclusiveMinimum)??Number.NEGATIVE_INFINITY;t.value>i&&(t.inclusive?r.minimum=t.value:r.exclusiveMinimum=t.value)}),e._zod.check=o=>{(t.inclusive?o.value>=t.value:o.value>t.value)||o.issues.push({origin:n,code:"too_small",minimum:t.value,input:o.value,inclusive:t.inclusive,inst:e,continue:!t.abort})}}),Dn=c("$ZodCheckMultipleOf",(e,t)=>{P.init(e,t),e._zod.onattach.push(n=>{var o;(o=n._zod.bag).multipleOf??(o.multipleOf=t.value)}),e._zod.check=n=>{if(typeof n.value!=typeof t.value)throw new Error("Cannot mix number and bigint in multiple_of check.");(typeof n.value=="bigint"?n.value%t.value===BigInt(0):qt(n.value,t.value)===0)||n.issues.push({origin:typeof n.value,code:"not_multiple_of",divisor:t.value,input:n.value,inst:e,continue:!t.abort})}}),Pn=c("$ZodCheckNumberFormat",(e,t)=>{P.init(e,t),t.format=t.format||"float64";const n=t.format?.includes("int"),o=n?"int":"number",[r,i]=Qt[t.format];e._zod.onattach.push(s=>{const u=s._zod.bag;u.format=t.format,u.minimum=r,u.maximum=i,n&&(u.pattern=An)}),e._zod.check=s=>{const u=s.value;if(n){if(!Number.isInteger(u)){s.issues.push({expected:o,format:t.format,code:"invalid_type",input:u,inst:e});return}if(!Number.isSafeInteger(u)){u>0?s.issues.push({input:u,code:"too_big",maximum:Number.MAX_SAFE_INTEGER,note:"Integers must be within the safe integer range.",inst:e,origin:o,continue:!t.abort}):s.issues.push({input:u,code:"too_small",minimum:Number.MIN_SAFE_INTEGER,note:"Integers must be within the safe integer range.",inst:e,origin:o,continue:!t.abort});return}}u<r&&s.issues.push({origin:"number",input:u,code:"too_small",minimum:r,inclusive:!0,inst:e,continue:!t.abort}),u>i&&s.issues.push({origin:"number",input:u,code:"too_big",maximum:i,inst:e})}}),Nn=c("$ZodCheckMaxLength",(e,t)=>{var n;P.init(e,t),(n=e._zod.def).when??(n.when=o=>{const r=o.value;return!be(r)&&r.length!==void 0}),e._zod.onattach.push(o=>{const r=o._zod.bag.maximum??Number.POSITIVE_INFINITY;t.maximum<r&&(o._zod.bag.maximum=t.maximum)}),e._zod.check=o=>{const r=o.value;if(r.length<=t.maximum)return;const s=ze(r);o.issues.push({origin:s,code:"too_big",maximum:t.maximum,inclusive:!0,input:r,inst:e,continue:!t.abort})}}),Fn=c("$ZodCheckMinLength",(e,t)=>{var n;P.init(e,t),(n=e._zod.def).when??(n.when=o=>{const r=o.value;return!be(r)&&r.length!==void 0}),e._zod.onattach.push(o=>{const r=o._zod.bag.minimum??Number.NEGATIVE_INFINITY;t.minimum>r&&(o._zod.bag.minimum=t.minimum)}),e._zod.check=o=>{const r=o.value;if(r.length>=t.minimum)return;const s=ze(r);o.issues.push({origin:s,code:"too_small",minimum:t.minimum,inclusive:!0,input:r,inst:e,continue:!t.abort})}}),Ln=c("$ZodCheckLengthEquals",(e,t)=>{var n;P.init(e,t),(n=e._zod.def).when??(n.when=o=>{const r=o.value;return!be(r)&&r.length!==void 0}),e._zod.onattach.push(o=>{const r=o._zod.bag;r.minimum=t.length,r.maximum=t.length,r.length=t.length}),e._zod.check=o=>{const r=o.value,i=r.length;if(i===t.length)return;const s=ze(r),u=i>t.length;o.issues.push({origin:s,...u?{code:"too_big",maximum:t.length}:{code:"too_small",minimum:t.length},inclusive:!0,exact:!0,input:o.value,inst:e,continue:!t.abort})}}),se=c("$ZodCheckStringFormat",(e,t)=>{var n,o;P.init(e,t),e._zod.onattach.push(r=>{const i=r._zod.bag;i.format=t.format,t.pattern&&(i.patterns??(i.patterns=new Set),i.patterns.add(t.pattern))}),t.pattern?(n=e._zod).check??(n.check=r=>{t.pattern.lastIndex=0,!t.pattern.test(r.value)&&r.issues.push({origin:"string",code:"invalid_format",format:t.format,input:r.value,...t.pattern?{pattern:t.pattern.toString()}:{},inst:e,continue:!t.abort})}):(o=e._zod).check??(o.check=()=>{})}),Un=c("$ZodCheckRegex",(e,t)=>{se.init(e,t),e._zod.check=n=>{t.pattern.lastIndex=0,!t.pattern.test(n.value)&&n.issues.push({origin:"string",code:"invalid_format",format:"regex",input:n.value,pattern:t.pattern.toString(),inst:e,continue:!t.abort})}}),Wn=c("$ZodCheckLowerCase",(e,t)=>{t.pattern??(t.pattern=xn),se.init(e,t)}),Mn=c("$ZodCheckUpperCase",(e,t)=>{t.pattern??(t.pattern=On),se.init(e,t)}),jn=c("$ZodCheckIncludes",(e,t)=>{P.init(e,t);const n=ie(t.includes),o=new RegExp(typeof t.position=="number"?`^.{${t.position}}${n}`:n);t.pattern=o,e._zod.onattach.push(r=>{const i=r._zod.bag;i.patterns??(i.patterns=new Set),i.patterns.add(o)}),e._zod.check=r=>{r.value.includes(t.includes,t.position)||r.issues.push({origin:"string",code:"invalid_format",format:"includes",includes:t.includes,input:r.value,inst:e,continue:!t.abort})}}),Bn=c("$ZodCheckStartsWith",(e,t)=>{P.init(e,t);const n=new RegExp(`^${ie(t.prefix)}.*`);t.pattern??(t.pattern=n),e._zod.onattach.push(o=>{const r=o._zod.bag;r.patterns??(r.patterns=new Set),r.patterns.add(n)}),e._zod.check=o=>{o.value.startsWith(t.prefix)||o.issues.push({origin:"string",code:"invalid_format",format:"starts_with",prefix:t.prefix,input:o.value,inst:e,continue:!t.abort})}}),qn=c("$ZodCheckEndsWith",(e,t)=>{P.init(e,t);const n=new RegExp(`.*${ie(t.suffix)}$`);t.pattern??(t.pattern=n),e._zod.onattach.push(o=>{const r=o._zod.bag;r.patterns??(r.patterns=new Set),r.patterns.add(n)}),e._zod.check=o=>{o.value.endsWith(t.suffix)||o.issues.push({origin:"string",code:"invalid_format",format:"ends_with",suffix:t.suffix,input:o.value,inst:e,continue:!t.abort})}}),Vn=c("$ZodCheckOverwrite",(e,t)=>{P.init(e,t),e._zod.check=n=>{n.value=t.tx(n.value)}});class Yn{constructor(t=[]){this.content=[],this.indent=0,this&&(this.args=t)}indented(t){this.indent+=1,t(this),this.indent-=1}write(t){if(typeof t=="function"){t(this,{execution:"sync"}),t(this,{execution:"async"});return}const o=t.split(`
`).filter(s=>s),r=Math.min(...o.map(s=>s.length-s.trimStart().length)),i=o.map(s=>s.slice(r)).map(s=>" ".repeat(this.indent*2)+s);for(const s of i)this.content.push(s)}compile(){const t=Function,n=this?.args,r=[...(this?.content??[""]).map(i=>`  ${i}`)];return new t(...n,r.join(`
`))}}const Gn={major:4,minor:0,patch:5},T=c("$ZodType",(e,t)=>{var n;e??(e={}),e._zod.def=t,e._zod.bag=e._zod.bag||{},e._zod.version=Gn;const o=[...e._zod.def.checks??[]];e._zod.traits.has("$ZodCheck")&&o.unshift(e);for(const r of o)for(const i of r._zod.onattach)i(e);if(o.length===0)(n=e._zod).deferred??(n.deferred=[]),e._zod.deferred?.push(()=>{e._zod.run=e._zod.parse});else{const r=(i,s,u)=>{let l=Q(i),p;for(const v of s){if(v._zod.def.when){if(!v._zod.def.when(i))continue}else if(l)continue;const h=i.issues.length,d=v._zod.check(i);if(d instanceof Promise&&u?.async===!1)throw new K;if(p||d instanceof Promise)p=(p??Promise.resolve()).then(async()=>{await d,i.issues.length!==h&&(l||(l=Q(i,h)))});else{if(i.issues.length===h)continue;l||(l=Q(i,h))}}return p?p.then(()=>i):i};e._zod.run=(i,s)=>{const u=e._zod.parse(i,s);if(u instanceof Promise){if(s.async===!1)throw new K;return u.then(l=>r(l,o,s))}return r(u,o,s)}}e["~standard"]={validate:r=>{try{const i=an(e,r);return i.success?{value:i.data}:{issues:i.error?.issues}}catch{return cn(e,r).then(s=>s.success?{value:s.data}:{issues:s.error?.issues})}},vendor:"zod",version:1}}),Se=c("$ZodString",(e,t)=>{T.init(e,t),e._zod.pattern=[...e?._zod.bag?.patterns??[]].pop()??In(e._zod.bag),e._zod.parse=(n,o)=>{if(t.coerce)try{n.value=String(n.value)}catch{}return typeof n.value=="string"||n.issues.push({expected:"string",code:"invalid_type",input:n.value,inst:e}),n}}),S=c("$ZodStringFormat",(e,t)=>{se.init(e,t),Se.init(e,t)}),Qn=c("$ZodGUID",(e,t)=>{t.pattern??(t.pattern=gn),S.init(e,t)}),Xn=c("$ZodUUID",(e,t)=>{if(t.version){const o={v1:1,v2:2,v3:3,v4:4,v5:5,v6:6,v7:7,v8:8}[t.version];if(o===void 0)throw new Error(`Invalid UUID version: "${t.version}"`);t.pattern??(t.pattern=De(o))}else t.pattern??(t.pattern=De());S.init(e,t)}),Kn=c("$ZodEmail",(e,t)=>{t.pattern??(t.pattern=_n),S.init(e,t)}),Jn=c("$ZodURL",(e,t)=>{S.init(e,t),e._zod.check=n=>{try{const o=n.value,r=new URL(o),i=r.href;t.hostname&&(t.hostname.lastIndex=0,t.hostname.test(r.hostname)||n.issues.push({code:"invalid_format",format:"url",note:"Invalid hostname",pattern:Sn.source,input:n.value,inst:e,continue:!t.abort})),t.protocol&&(t.protocol.lastIndex=0,t.protocol.test(r.protocol.endsWith(":")?r.protocol.slice(0,-1):r.protocol)||n.issues.push({code:"invalid_format",format:"url",note:"Invalid protocol",pattern:t.protocol.source,input:n.value,inst:e,continue:!t.abort})),!o.endsWith("/")&&i.endsWith("/")?n.value=i.slice(0,-1):n.value=i;return}catch{n.issues.push({code:"invalid_format",format:"url",input:n.value,inst:e,continue:!t.abort})}}}),Hn=c("$ZodEmoji",(e,t)=>{t.pattern??(t.pattern=wn()),S.init(e,t)}),eo=c("$ZodNanoID",(e,t)=>{t.pattern??(t.pattern=fn),S.init(e,t)}),to=c("$ZodCUID",(e,t)=>{t.pattern??(t.pattern=un),S.init(e,t)}),no=c("$ZodCUID2",(e,t)=>{t.pattern??(t.pattern=ln),S.init(e,t)}),oo=c("$ZodULID",(e,t)=>{t.pattern??(t.pattern=dn),S.init(e,t)}),ro=c("$ZodXID",(e,t)=>{t.pattern??(t.pattern=pn),S.init(e,t)}),io=c("$ZodKSUID",(e,t)=>{t.pattern??(t.pattern=hn),S.init(e,t)}),so=c("$ZodISODateTime",(e,t)=>{t.pattern??(t.pattern=Tn(t)),S.init(e,t)}),ao=c("$ZodISODate",(e,t)=>{t.pattern??(t.pattern=Cn),S.init(e,t)}),co=c("$ZodISOTime",(e,t)=>{t.pattern??(t.pattern=$n(t)),S.init(e,t)}),uo=c("$ZodISODuration",(e,t)=>{t.pattern??(t.pattern=mn),S.init(e,t)}),lo=c("$ZodIPv4",(e,t)=>{t.pattern??(t.pattern=bn),S.init(e,t),e._zod.onattach.push(n=>{const o=n._zod.bag;o.format="ipv4"})}),po=c("$ZodIPv6",(e,t)=>{t.pattern??(t.pattern=yn),S.init(e,t),e._zod.onattach.push(n=>{const o=n._zod.bag;o.format="ipv6"}),e._zod.check=n=>{try{new URL(`http://[${n.value}]`)}catch{n.issues.push({code:"invalid_format",format:"ipv6",input:n.value,inst:e,continue:!t.abort})}}}),ho=c("$ZodCIDRv4",(e,t)=>{t.pattern??(t.pattern=kn),S.init(e,t)}),fo=c("$ZodCIDRv6",(e,t)=>{t.pattern??(t.pattern=En),S.init(e,t),e._zod.check=n=>{const[o,r]=n.value.split("/");try{if(!r)throw new Error;const i=Number(r);if(`${i}`!==r)throw new Error;if(i<0||i>128)throw new Error;new URL(`http://[${o}]`)}catch{n.issues.push({code:"invalid_format",format:"cidrv6",input:n.value,inst:e,continue:!t.abort})}}});function wt(e){if(e==="")return!0;if(e.length%4!==0)return!1;try{return atob(e),!0}catch{return!1}}const mo=c("$ZodBase64",(e,t)=>{t.pattern??(t.pattern=zn),S.init(e,t),e._zod.onattach.push(n=>{n._zod.bag.contentEncoding="base64"}),e._zod.check=n=>{wt(n.value)||n.issues.push({code:"invalid_format",format:"base64",input:n.value,inst:e,continue:!t.abort})}});function go(e){if(!ht.test(e))return!1;const t=e.replace(/[-_]/g,o=>o==="-"?"+":"/"),n=t.padEnd(Math.ceil(t.length/4)*4,"=");return wt(n)}const _o=c("$ZodBase64URL",(e,t)=>{t.pattern??(t.pattern=ht),S.init(e,t),e._zod.onattach.push(n=>{n._zod.bag.contentEncoding="base64url"}),e._zod.check=n=>{go(n.value)||n.issues.push({code:"invalid_format",format:"base64url",input:n.value,inst:e,continue:!t.abort})}}),vo=c("$ZodE164",(e,t)=>{t.pattern??(t.pattern=Zn),S.init(e,t)});function wo(e,t=null){try{const n=e.split(".");if(n.length!==3)return!1;const[o]=n;if(!o)return!1;const r=JSON.parse(atob(o));return!("typ"in r&&r?.typ!=="JWT"||!r.alg||t&&(!("alg"in r)||r.alg!==t))}catch{return!1}}const bo=c("$ZodJWT",(e,t)=>{S.init(e,t),e._zod.check=n=>{wo(n.value,t.alg)||n.issues.push({code:"invalid_format",format:"jwt",input:n.value,inst:e,continue:!t.abort})}}),bt=c("$ZodNumber",(e,t)=>{T.init(e,t),e._zod.pattern=e._zod.bag.pattern??Rn,e._zod.parse=(n,o)=>{if(t.coerce)try{n.value=Number(n.value)}catch{}const r=n.value;if(typeof r=="number"&&!Number.isNaN(r)&&Number.isFinite(r))return n;const i=typeof r=="number"?Number.isNaN(r)?"NaN":Number.isFinite(r)?void 0:"Infinity":void 0;return n.issues.push({expected:"number",code:"invalid_type",input:r,inst:e,...i?{received:i}:{}}),n}}),yo=c("$ZodNumber",(e,t)=>{Pn.init(e,t),bt.init(e,t)}),ko=c("$ZodAny",(e,t)=>{T.init(e,t),e._zod.parse=n=>n}),Eo=c("$ZodUnknown",(e,t)=>{T.init(e,t),e._zod.parse=n=>n}),zo=c("$ZodNever",(e,t)=>{T.init(e,t),e._zod.parse=(n,o)=>(n.issues.push({expected:"never",code:"invalid_type",input:n.value,inst:e}),n)});function Pe(e,t,n){e.issues.length&&t.issues.push(...Ee(n,e.issues)),t.value[n]=e.value}const So=c("$ZodArray",(e,t)=>{T.init(e,t),e._zod.parse=(n,o)=>{const r=n.value;if(!Array.isArray(r))return n.issues.push({expected:"array",code:"invalid_type",input:r,inst:e}),n;n.value=Array(r.length);const i=[];for(let s=0;s<r.length;s++){const u=r[s],l=t.element._zod.run({value:u,issues:[]},o);l instanceof Promise?i.push(l.then(p=>Pe(p,n,s))):Pe(l,n,s)}return i.length?Promise.all(i).then(()=>n):n}});function te(e,t,n){e.issues.length&&t.issues.push(...Ee(n,e.issues)),t.value[n]=e.value}function Ne(e,t,n,o){e.issues.length?o[n]===void 0?n in o?t.value[n]=void 0:t.value[n]=e.value:t.issues.push(...Ee(n,e.issues)):e.value===void 0?n in o&&(t.value[n]=void 0):t.value[n]=e.value}const Zo=c("$ZodObject",(e,t)=>{T.init(e,t);const n=st(()=>{const h=Object.keys(t.shape);for(const g of h)if(!(t.shape[g]instanceof T))throw new Error(`Invalid element at key "${g}": expected a Zod schema`);const d=Gt(t.shape);return{shape:t.shape,keys:h,keySet:new Set(h),numKeys:h.length,optionalKeys:new Set(d)}});z(e._zod,"propValues",()=>{const h=t.shape,d={};for(const g in h){const y=h[g]._zod;if(y.values){d[g]??(d[g]=new Set);for(const A of y.values)d[g].add(A)}}return d});const o=h=>{const d=new Yn(["shape","payload","ctx"]),g=n.value,y=C=>{const k=G(C);return`shape[${k}]._zod.run({ value: input[${k}], issues: [] }, ctx)`};d.write("const input = payload.value;");const A=Object.create(null);let x=0;for(const C of g.keys)A[C]=`key_${x++}`;d.write("const newResult = {}");for(const C of g.keys)if(g.optionalKeys.has(C)){const k=A[C];d.write(`const ${k} = ${y(C)};`);const $=G(C);d.write(`
        if (${k}.issues.length) {
          if (input[${$}] === undefined) {
            if (${$} in input) {
              newResult[${$}] = undefined;
            }
          } else {
            payload.issues = payload.issues.concat(
              ${k}.issues.map((iss) => ({
                ...iss,
                path: iss.path ? [${$}, ...iss.path] : [${$}],
              }))
            );
          }
        } else if (${k}.value === undefined) {
          if (${$} in input) newResult[${$}] = undefined;
        } else {
          newResult[${$}] = ${k}.value;
        }
        `)}else{const k=A[C];d.write(`const ${k} = ${y(C)};`),d.write(`
          if (${k}.issues.length) payload.issues = payload.issues.concat(${k}.issues.map(iss => ({
            ...iss,
            path: iss.path ? [${G(C)}, ...iss.path] : [${G(C)}]
          })));`),d.write(`newResult[${G(C)}] = ${k}.value`)}d.write("payload.value = newResult;"),d.write("return payload;");const D=d.compile();return(C,k)=>D(h,C,k)};let r;const i=he,s=!it.jitless,l=s&&Vt.value,p=t.catchall;let v;e._zod.parse=(h,d)=>{v??(v=n.value);const g=h.value;if(!i(g))return h.issues.push({expected:"object",code:"invalid_type",input:g,inst:e}),h;const y=[];if(s&&l&&d?.async===!1&&d.jitless!==!0)r||(r=o(t.shape)),h=r(h,d);else{h.value={};const k=v.shape;for(const $ of v.keys){const L=k[$],W=L._zod.run({value:g[$],issues:[]},d),q=L._zod.optin==="optional"&&L._zod.optout==="optional";W instanceof Promise?y.push(W.then(V=>q?Ne(V,h,$,g):te(V,h,$))):q?Ne(W,h,$,g):te(W,h,$)}}if(!p)return y.length?Promise.all(y).then(()=>h):h;const A=[],x=v.keySet,D=p._zod,C=D.def.type;for(const k of Object.keys(g)){if(x.has(k))continue;if(C==="never"){A.push(k);continue}const $=D.run({value:g[k],issues:[]},d);$ instanceof Promise?y.push($.then(L=>te(L,h,k))):te($,h,k)}return A.length&&h.issues.push({code:"unrecognized_keys",keys:A,input:g,inst:e}),y.length?Promise.all(y).then(()=>h):h}});function Fe(e,t,n,o){for(const r of e)if(r.issues.length===0)return t.value=r.value,t;return t.issues.push({code:"invalid_union",input:t.value,inst:n,errors:e.map(r=>r.issues.map(i=>j(i,o,M())))}),t}const Co=c("$ZodUnion",(e,t)=>{T.init(e,t),z(e._zod,"optin",()=>t.options.some(n=>n._zod.optin==="optional")?"optional":void 0),z(e._zod,"optout",()=>t.options.some(n=>n._zod.optout==="optional")?"optional":void 0),z(e._zod,"values",()=>{if(t.options.every(n=>n._zod.values))return new Set(t.options.flatMap(n=>Array.from(n._zod.values)))}),z(e._zod,"pattern",()=>{if(t.options.every(n=>n._zod.pattern)){const n=t.options.map(o=>o._zod.pattern);return new RegExp(`^(${n.map(o=>ye(o.source)).join("|")})$`)}}),e._zod.parse=(n,o)=>{let r=!1;const i=[];for(const s of t.options){const u=s._zod.run({value:n.value,issues:[]},o);if(u instanceof Promise)i.push(u),r=!0;else{if(u.issues.length===0)return u;i.push(u)}}return r?Promise.all(i).then(s=>Fe(s,n,e,o)):Fe(i,n,e,o)}}),$o=c("$ZodIntersection",(e,t)=>{T.init(e,t),e._zod.parse=(n,o)=>{const r=n.value,i=t.left._zod.run({value:r,issues:[]},o),s=t.right._zod.run({value:r,issues:[]},o);return i instanceof Promise||s instanceof Promise?Promise.all([i,s]).then(([l,p])=>Le(n,l,p)):Le(n,i,s)}});function me(e,t){if(e===t)return{valid:!0,data:e};if(e instanceof Date&&t instanceof Date&&+e==+t)return{valid:!0,data:e};if(fe(e)&&fe(t)){const n=Object.keys(t),o=Object.keys(e).filter(i=>n.indexOf(i)!==-1),r={...e,...t};for(const i of o){const s=me(e[i],t[i]);if(!s.valid)return{valid:!1,mergeErrorPath:[i,...s.mergeErrorPath]};r[i]=s.data}return{valid:!0,data:r}}if(Array.isArray(e)&&Array.isArray(t)){if(e.length!==t.length)return{valid:!1,mergeErrorPath:[]};const n=[];for(let o=0;o<e.length;o++){const r=e[o],i=t[o],s=me(r,i);if(!s.valid)return{valid:!1,mergeErrorPath:[o,...s.mergeErrorPath]};n.push(s.data)}return{valid:!0,data:n}}return{valid:!1,mergeErrorPath:[]}}function Le(e,t,n){if(t.issues.length&&e.issues.push(...t.issues),n.issues.length&&e.issues.push(...n.issues),Q(e))return e;const o=me(t.value,n.value);if(!o.valid)throw new Error(`Unmergable intersection. Error path: ${JSON.stringify(o.mergeErrorPath)}`);return e.value=o.data,e}const To=c("$ZodEnum",(e,t)=>{T.init(e,t);const n=jt(t.entries);e._zod.values=new Set(n),e._zod.pattern=new RegExp(`^(${n.filter(o=>Yt.has(typeof o)).map(o=>typeof o=="string"?ie(o):o.toString()).join("|")})$`),e._zod.parse=(o,r)=>{const i=o.value;return e._zod.values.has(i)||o.issues.push({code:"invalid_value",values:n,input:i,inst:e}),o}}),Io=c("$ZodTransform",(e,t)=>{T.init(e,t),e._zod.parse=(n,o)=>{const r=t.transform(n.value,n);if(o.async)return(r instanceof Promise?r:Promise.resolve(r)).then(s=>(n.value=s,n));if(r instanceof Promise)throw new K;return n.value=r,n}}),Ao=c("$ZodOptional",(e,t)=>{T.init(e,t),e._zod.optin="optional",e._zod.optout="optional",z(e._zod,"values",()=>t.innerType._zod.values?new Set([...t.innerType._zod.values,void 0]):void 0),z(e._zod,"pattern",()=>{const n=t.innerType._zod.pattern;return n?new RegExp(`^(${ye(n.source)})?$`):void 0}),e._zod.parse=(n,o)=>t.innerType._zod.optin==="optional"?t.innerType._zod.run(n,o):n.value===void 0?n:t.innerType._zod.run(n,o)}),Ro=c("$ZodNullable",(e,t)=>{T.init(e,t),z(e._zod,"optin",()=>t.innerType._zod.optin),z(e._zod,"optout",()=>t.innerType._zod.optout),z(e._zod,"pattern",()=>{const n=t.innerType._zod.pattern;return n?new RegExp(`^(${ye(n.source)}|null)$`):void 0}),z(e._zod,"values",()=>t.innerType._zod.values?new Set([...t.innerType._zod.values,null]):void 0),e._zod.parse=(n,o)=>n.value===null?n:t.innerType._zod.run(n,o)}),xo=c("$ZodDefault",(e,t)=>{T.init(e,t),e._zod.optin="optional",z(e._zod,"values",()=>t.innerType._zod.values),e._zod.parse=(n,o)=>{if(n.value===void 0)return n.value=t.defaultValue,n;const r=t.innerType._zod.run(n,o);return r instanceof Promise?r.then(i=>Ue(i,t)):Ue(r,t)}});function Ue(e,t){return e.value===void 0&&(e.value=t.defaultValue),e}const Oo=c("$ZodPrefault",(e,t)=>{T.init(e,t),e._zod.optin="optional",z(e._zod,"values",()=>t.innerType._zod.values),e._zod.parse=(n,o)=>(n.value===void 0&&(n.value=t.defaultValue),t.innerType._zod.run(n,o))}),Do=c("$ZodNonOptional",(e,t)=>{T.init(e,t),z(e._zod,"values",()=>{const n=t.innerType._zod.values;return n?new Set([...n].filter(o=>o!==void 0)):void 0}),e._zod.parse=(n,o)=>{const r=t.innerType._zod.run(n,o);return r instanceof Promise?r.then(i=>We(i,e)):We(r,e)}});function We(e,t){return!e.issues.length&&e.value===void 0&&e.issues.push({code:"invalid_type",expected:"nonoptional",input:e.value,inst:t}),e}const Po=c("$ZodCatch",(e,t)=>{T.init(e,t),e._zod.optin="optional",z(e._zod,"optout",()=>t.innerType._zod.optout),z(e._zod,"values",()=>t.innerType._zod.values),e._zod.parse=(n,o)=>{const r=t.innerType._zod.run(n,o);return r instanceof Promise?r.then(i=>(n.value=i.value,i.issues.length&&(n.value=t.catchValue({...n,error:{issues:i.issues.map(s=>j(s,o,M()))},input:n.value}),n.issues=[]),n)):(n.value=r.value,r.issues.length&&(n.value=t.catchValue({...n,error:{issues:r.issues.map(i=>j(i,o,M()))},input:n.value}),n.issues=[]),n)}}),No=c("$ZodPipe",(e,t)=>{T.init(e,t),z(e._zod,"values",()=>t.in._zod.values),z(e._zod,"optin",()=>t.in._zod.optin),z(e._zod,"optout",()=>t.out._zod.optout),z(e._zod,"propValues",()=>t.in._zod.propValues),e._zod.parse=(n,o)=>{const r=t.in._zod.run(n,o);return r instanceof Promise?r.then(i=>Me(i,t,o)):Me(r,t,o)}});function Me(e,t,n){return Q(e)?e:t.out._zod.run({value:e.value,issues:e.issues},n)}const Fo=c("$ZodReadonly",(e,t)=>{T.init(e,t),z(e._zod,"propValues",()=>t.innerType._zod.propValues),z(e._zod,"values",()=>t.innerType._zod.values),z(e._zod,"optin",()=>t.innerType._zod.optin),z(e._zod,"optout",()=>t.innerType._zod.optout),e._zod.parse=(n,o)=>{const r=t.innerType._zod.run(n,o);return r instanceof Promise?r.then(je):je(r)}});function je(e){return e.value=Object.freeze(e.value),e}const Lo=c("$ZodCustom",(e,t)=>{P.init(e,t),T.init(e,t),e._zod.parse=(n,o)=>n,e._zod.check=n=>{const o=n.value,r=t.fn(o);if(r instanceof Promise)return r.then(i=>Be(i,n,o,e));Be(r,n,o,e)}});function Be(e,t,n,o){if(!e){const r={code:"custom",input:n,inst:o,path:[...o._zod.def.path??[]],continue:!o._zod.def.abort};o._zod.def.params&&(r.params=o._zod.def.params),t.issues.push(J(r))}}class Uo{constructor(){this._map=new Map,this._idmap=new Map}add(t,...n){const o=n[0];if(this._map.set(t,o),o&&typeof o=="object"&&"id"in o){if(this._idmap.has(o.id))throw new Error(`ID ${o.id} already exists in the registry`);this._idmap.set(o.id,t)}return this}clear(){return this._map=new Map,this._idmap=new Map,this}remove(t){const n=this._map.get(t);return n&&typeof n=="object"&&"id"in n&&this._idmap.delete(n.id),this._map.delete(t),this}get(t){const n=t._zod.parent;if(n){const o={...this.get(n)??{}};return delete o.id,{...o,...this._map.get(t)}}return this._map.get(t)}has(t){return this._map.has(t)}}function Wo(){return new Uo}const ne=Wo();function Mo(e,t){return new e({type:"string",...m(t)})}function jo(e,t){return new e({type:"string",format:"email",check:"string_format",abort:!1,...m(t)})}function qe(e,t){return new e({type:"string",format:"guid",check:"string_format",abort:!1,...m(t)})}function Bo(e,t){return new e({type:"string",format:"uuid",check:"string_format",abort:!1,...m(t)})}function qo(e,t){return new e({type:"string",format:"uuid",check:"string_format",abort:!1,version:"v4",...m(t)})}function Vo(e,t){return new e({type:"string",format:"uuid",check:"string_format",abort:!1,version:"v6",...m(t)})}function Yo(e,t){return new e({type:"string",format:"uuid",check:"string_format",abort:!1,version:"v7",...m(t)})}function Go(e,t){return new e({type:"string",format:"url",check:"string_format",abort:!1,...m(t)})}function Qo(e,t){return new e({type:"string",format:"emoji",check:"string_format",abort:!1,...m(t)})}function Xo(e,t){return new e({type:"string",format:"nanoid",check:"string_format",abort:!1,...m(t)})}function Ko(e,t){return new e({type:"string",format:"cuid",check:"string_format",abort:!1,...m(t)})}function Jo(e,t){return new e({type:"string",format:"cuid2",check:"string_format",abort:!1,...m(t)})}function Ho(e,t){return new e({type:"string",format:"ulid",check:"string_format",abort:!1,...m(t)})}function er(e,t){return new e({type:"string",format:"xid",check:"string_format",abort:!1,...m(t)})}function tr(e,t){return new e({type:"string",format:"ksuid",check:"string_format",abort:!1,...m(t)})}function nr(e,t){return new e({type:"string",format:"ipv4",check:"string_format",abort:!1,...m(t)})}function or(e,t){return new e({type:"string",format:"ipv6",check:"string_format",abort:!1,...m(t)})}function rr(e,t){return new e({type:"string",format:"cidrv4",check:"string_format",abort:!1,...m(t)})}function ir(e,t){return new e({type:"string",format:"cidrv6",check:"string_format",abort:!1,...m(t)})}function sr(e,t){return new e({type:"string",format:"base64",check:"string_format",abort:!1,...m(t)})}function ar(e,t){return new e({type:"string",format:"base64url",check:"string_format",abort:!1,...m(t)})}function cr(e,t){return new e({type:"string",format:"e164",check:"string_format",abort:!1,...m(t)})}function ur(e,t){return new e({type:"string",format:"jwt",check:"string_format",abort:!1,...m(t)})}function lr(e,t){return new e({type:"string",format:"datetime",check:"string_format",offset:!1,local:!1,precision:null,...m(t)})}function dr(e,t){return new e({type:"string",format:"date",check:"string_format",...m(t)})}function pr(e,t){return new e({type:"string",format:"time",check:"string_format",precision:null,...m(t)})}function hr(e,t){return new e({type:"string",format:"duration",check:"string_format",...m(t)})}function fr(e,t){return new e({type:"number",checks:[],...m(t)})}function mr(e,t){return new e({type:"number",check:"number_format",abort:!1,format:"safeint",...m(t)})}function gr(e){return new e({type:"any"})}function _r(e){return new e({type:"unknown"})}function vr(e,t){return new e({type:"never",...m(t)})}function Ve(e,t){return new _t({check:"less_than",...m(t),value:e,inclusive:!1})}function de(e,t){return new _t({check:"less_than",...m(t),value:e,inclusive:!0})}function Ye(e,t){return new vt({check:"greater_than",...m(t),value:e,inclusive:!1})}function pe(e,t){return new vt({check:"greater_than",...m(t),value:e,inclusive:!0})}function Ge(e,t){return new Dn({check:"multiple_of",...m(t),value:e})}function yt(e,t){return new Nn({check:"max_length",...m(t),maximum:e})}function re(e,t){return new Fn({check:"min_length",...m(t),minimum:e})}function kt(e,t){return new Ln({check:"length_equals",...m(t),length:e})}function wr(e,t){return new Un({check:"string_format",format:"regex",...m(t),pattern:e})}function br(e){return new Wn({check:"string_format",format:"lowercase",...m(e)})}function yr(e){return new Mn({check:"string_format",format:"uppercase",...m(e)})}function kr(e,t){return new jn({check:"string_format",format:"includes",...m(t),includes:e})}function Er(e,t){return new Bn({check:"string_format",format:"starts_with",...m(t),prefix:e})}function zr(e,t){return new qn({check:"string_format",format:"ends_with",...m(t),suffix:e})}function H(e){return new Vn({check:"overwrite",tx:e})}function Sr(e){return H(t=>t.normalize(e))}function Zr(){return H(e=>e.trim())}function Cr(){return H(e=>e.toLowerCase())}function $r(){return H(e=>e.toUpperCase())}function Tr(e,t,n){return new e({type:"array",element:t,...m(n)})}function Ir(e,t,n){return new e({type:"custom",check:"custom",fn:t,...m(n)})}const Ar=c("ZodISODateTime",(e,t)=>{so.init(e,t),Z.init(e,t)});function Rr(e){return lr(Ar,e)}const xr=c("ZodISODate",(e,t)=>{ao.init(e,t),Z.init(e,t)});function Or(e){return dr(xr,e)}const Dr=c("ZodISOTime",(e,t)=>{co.init(e,t),Z.init(e,t)});function Pr(e){return pr(Dr,e)}const Nr=c("ZodISODuration",(e,t)=>{uo.init(e,t),Z.init(e,t)});function Fr(e){return hr(Nr,e)}const Lr=(e,t)=>{ut.init(e,t),e.name="ZodError",Object.defineProperties(e,{format:{value:n=>on(e,n)},flatten:{value:n=>nn(e,n)},addIssue:{value:n=>e.issues.push(n)},addIssues:{value:n=>e.issues.push(...n)},isEmpty:{get(){return e.issues.length===0}}})},ae=c("ZodError",Lr,{Parent:Error}),Ur=rn(ae),Wr=sn(ae),Mr=dt(ae),jr=pt(ae),I=c("ZodType",(e,t)=>(T.init(e,t),e.def=t,Object.defineProperty(e,"_def",{value:t}),e.check=(...n)=>e.clone({...t,checks:[...t.checks??[],...n.map(o=>typeof o=="function"?{_zod:{check:o,def:{check:"custom"},onattach:[]}}:o)]}),e.clone=(n,o)=>B(e,n,o),e.brand=()=>e,e.register=(n,o)=>(n.add(e,o),e),e.parse=(n,o)=>Ur(e,n,o,{callee:e.parse}),e.safeParse=(n,o)=>Mr(e,n,o),e.parseAsync=async(n,o)=>Wr(e,n,o,{callee:e.parseAsync}),e.safeParseAsync=async(n,o)=>jr(e,n,o),e.spa=e.safeParseAsync,e.refine=(n,o)=>e.check(Pi(n,o)),e.superRefine=n=>e.check(Ni(n)),e.overwrite=n=>e.check(H(n)),e.optional=()=>Je(e),e.nullable=()=>He(e),e.nullish=()=>Je(He(e)),e.nonoptional=n=>$i(e,n),e.array=()=>Ze(e),e.or=n=>_i([e,n]),e.and=n=>wi(e,n),e.transform=n=>et(e,ki(n)),e.default=n=>Si(e,n),e.prefault=n=>Ci(e,n),e.catch=n=>Ii(e,n),e.pipe=n=>et(e,n),e.readonly=()=>xi(e),e.describe=n=>{const o=e.clone();return ne.add(o,{description:n}),o},Object.defineProperty(e,"description",{get(){return ne.get(e)?.description},configurable:!0}),e.meta=(...n)=>{if(n.length===0)return ne.get(e);const o=e.clone();return ne.add(o,n[0]),o},e.isOptional=()=>e.safeParse(void 0).success,e.isNullable=()=>e.safeParse(null).success,e)),Et=c("_ZodString",(e,t)=>{Se.init(e,t),I.init(e,t);const n=e._zod.bag;e.format=n.format??null,e.minLength=n.minimum??null,e.maxLength=n.maximum??null,e.regex=(...o)=>e.check(wr(...o)),e.includes=(...o)=>e.check(kr(...o)),e.startsWith=(...o)=>e.check(Er(...o)),e.endsWith=(...o)=>e.check(zr(...o)),e.min=(...o)=>e.check(re(...o)),e.max=(...o)=>e.check(yt(...o)),e.length=(...o)=>e.check(kt(...o)),e.nonempty=(...o)=>e.check(re(1,...o)),e.lowercase=o=>e.check(br(o)),e.uppercase=o=>e.check(yr(o)),e.trim=()=>e.check(Zr()),e.normalize=(...o)=>e.check(Sr(...o)),e.toLowerCase=()=>e.check(Cr()),e.toUpperCase=()=>e.check($r())}),Br=c("ZodString",(e,t)=>{Se.init(e,t),Et.init(e,t),e.email=n=>e.check(jo(qr,n)),e.url=n=>e.check(Go(Vr,n)),e.jwt=n=>e.check(ur(ai,n)),e.emoji=n=>e.check(Qo(Yr,n)),e.guid=n=>e.check(qe(Qe,n)),e.uuid=n=>e.check(Bo(oe,n)),e.uuidv4=n=>e.check(qo(oe,n)),e.uuidv6=n=>e.check(Vo(oe,n)),e.uuidv7=n=>e.check(Yo(oe,n)),e.nanoid=n=>e.check(Xo(Gr,n)),e.guid=n=>e.check(qe(Qe,n)),e.cuid=n=>e.check(Ko(Qr,n)),e.cuid2=n=>e.check(Jo(Xr,n)),e.ulid=n=>e.check(Ho(Kr,n)),e.base64=n=>e.check(sr(ri,n)),e.base64url=n=>e.check(ar(ii,n)),e.xid=n=>e.check(er(Jr,n)),e.ksuid=n=>e.check(tr(Hr,n)),e.ipv4=n=>e.check(nr(ei,n)),e.ipv6=n=>e.check(or(ti,n)),e.cidrv4=n=>e.check(rr(ni,n)),e.cidrv6=n=>e.check(ir(oi,n)),e.e164=n=>e.check(cr(si,n)),e.datetime=n=>e.check(Rr(n)),e.date=n=>e.check(Or(n)),e.time=n=>e.check(Pr(n)),e.duration=n=>e.check(Fr(n))});function X(e){return Mo(Br,e)}const Z=c("ZodStringFormat",(e,t)=>{S.init(e,t),Et.init(e,t)}),qr=c("ZodEmail",(e,t)=>{Kn.init(e,t),Z.init(e,t)}),Qe=c("ZodGUID",(e,t)=>{Qn.init(e,t),Z.init(e,t)}),oe=c("ZodUUID",(e,t)=>{Xn.init(e,t),Z.init(e,t)}),Vr=c("ZodURL",(e,t)=>{Jn.init(e,t),Z.init(e,t)}),Yr=c("ZodEmoji",(e,t)=>{Hn.init(e,t),Z.init(e,t)}),Gr=c("ZodNanoID",(e,t)=>{eo.init(e,t),Z.init(e,t)}),Qr=c("ZodCUID",(e,t)=>{to.init(e,t),Z.init(e,t)}),Xr=c("ZodCUID2",(e,t)=>{no.init(e,t),Z.init(e,t)}),Kr=c("ZodULID",(e,t)=>{oo.init(e,t),Z.init(e,t)}),Jr=c("ZodXID",(e,t)=>{ro.init(e,t),Z.init(e,t)}),Hr=c("ZodKSUID",(e,t)=>{io.init(e,t),Z.init(e,t)}),ei=c("ZodIPv4",(e,t)=>{lo.init(e,t),Z.init(e,t)}),ti=c("ZodIPv6",(e,t)=>{po.init(e,t),Z.init(e,t)}),ni=c("ZodCIDRv4",(e,t)=>{ho.init(e,t),Z.init(e,t)}),oi=c("ZodCIDRv6",(e,t)=>{fo.init(e,t),Z.init(e,t)}),ri=c("ZodBase64",(e,t)=>{mo.init(e,t),Z.init(e,t)}),ii=c("ZodBase64URL",(e,t)=>{_o.init(e,t),Z.init(e,t)}),si=c("ZodE164",(e,t)=>{vo.init(e,t),Z.init(e,t)}),ai=c("ZodJWT",(e,t)=>{bo.init(e,t),Z.init(e,t)}),zt=c("ZodNumber",(e,t)=>{bt.init(e,t),I.init(e,t),e.gt=(o,r)=>e.check(Ye(o,r)),e.gte=(o,r)=>e.check(pe(o,r)),e.min=(o,r)=>e.check(pe(o,r)),e.lt=(o,r)=>e.check(Ve(o,r)),e.lte=(o,r)=>e.check(de(o,r)),e.max=(o,r)=>e.check(de(o,r)),e.int=o=>e.check(Xe(o)),e.safe=o=>e.check(Xe(o)),e.positive=o=>e.check(Ye(0,o)),e.nonnegative=o=>e.check(pe(0,o)),e.negative=o=>e.check(Ve(0,o)),e.nonpositive=o=>e.check(de(0,o)),e.multipleOf=(o,r)=>e.check(Ge(o,r)),e.step=(o,r)=>e.check(Ge(o,r)),e.finite=()=>e;const n=e._zod.bag;e.minValue=Math.max(n.minimum??Number.NEGATIVE_INFINITY,n.exclusiveMinimum??Number.NEGATIVE_INFINITY)??null,e.maxValue=Math.min(n.maximum??Number.POSITIVE_INFINITY,n.exclusiveMaximum??Number.POSITIVE_INFINITY)??null,e.isInt=(n.format??"").includes("int")||Number.isSafeInteger(n.multipleOf??.5),e.isFinite=!0,e.format=n.format??null});function Qi(e){return fr(zt,e)}const ci=c("ZodNumberFormat",(e,t)=>{yo.init(e,t),zt.init(e,t)});function Xe(e){return mr(ci,e)}const ui=c("ZodAny",(e,t)=>{ko.init(e,t),I.init(e,t)});function li(){return gr(ui)}const di=c("ZodUnknown",(e,t)=>{Eo.init(e,t),I.init(e,t)});function Ke(){return _r(di)}const pi=c("ZodNever",(e,t)=>{zo.init(e,t),I.init(e,t)});function hi(e){return vr(pi,e)}const fi=c("ZodArray",(e,t)=>{So.init(e,t),I.init(e,t),e.element=t.element,e.min=(n,o)=>e.check(re(n,o)),e.nonempty=n=>e.check(re(1,n)),e.max=(n,o)=>e.check(yt(n,o)),e.length=(n,o)=>e.check(kt(n,o)),e.unwrap=()=>e.element});function Ze(e,t){return Tr(fi,e,t)}const mi=c("ZodObject",(e,t)=>{Zo.init(e,t),I.init(e,t),z(e,"shape",()=>t.shape),e.keyof=()=>bi(Object.keys(e._zod.def.shape)),e.catchall=n=>e.clone({...e._zod.def,catchall:n}),e.passthrough=()=>e.clone({...e._zod.def,catchall:Ke()}),e.loose=()=>e.clone({...e._zod.def,catchall:Ke()}),e.strict=()=>e.clone({...e._zod.def,catchall:hi()}),e.strip=()=>e.clone({...e._zod.def,catchall:void 0}),e.extend=n=>Jt(e,n),e.merge=n=>Ht(e,n),e.pick=n=>Xt(e,n),e.omit=n=>Kt(e,n),e.partial=(...n)=>en(St,e,n[0]),e.required=(...n)=>tn(Zt,e,n[0])});function Ce(e,t){const n={type:"object",get shape(){return ke(this,"shape",{...e}),this.shape},...m(t)};return new mi(n)}const gi=c("ZodUnion",(e,t)=>{Co.init(e,t),I.init(e,t),e.options=t.options});function _i(e,t){return new gi({type:"union",options:e,...m(t)})}const vi=c("ZodIntersection",(e,t)=>{$o.init(e,t),I.init(e,t)});function wi(e,t){return new vi({type:"intersection",left:e,right:t})}const ge=c("ZodEnum",(e,t)=>{To.init(e,t),I.init(e,t),e.enum=t.entries,e.options=Object.values(t.entries);const n=new Set(Object.keys(t.entries));e.extract=(o,r)=>{const i={};for(const s of o)if(n.has(s))i[s]=t.entries[s];else throw new Error(`Key ${s} not found in enum`);return new ge({...t,checks:[],...m(r),entries:i})},e.exclude=(o,r)=>{const i={...t.entries};for(const s of o)if(n.has(s))delete i[s];else throw new Error(`Key ${s} not found in enum`);return new ge({...t,checks:[],...m(r),entries:i})}});function bi(e,t){const n=Array.isArray(e)?Object.fromEntries(e.map(o=>[o,o])):e;return new ge({type:"enum",entries:n,...m(t)})}const yi=c("ZodTransform",(e,t)=>{Io.init(e,t),I.init(e,t),e._zod.parse=(n,o)=>{n.addIssue=i=>{if(typeof i=="string")n.issues.push(J(i,n.value,t));else{const s=i;s.fatal&&(s.continue=!1),s.code??(s.code="custom"),s.input??(s.input=n.value),s.inst??(s.inst=e),s.continue??(s.continue=!0),n.issues.push(J(s))}};const r=t.transform(n.value,n);return r instanceof Promise?r.then(i=>(n.value=i,n)):(n.value=r,n)}});function ki(e){return new yi({type:"transform",transform:e})}const St=c("ZodOptional",(e,t)=>{Ao.init(e,t),I.init(e,t),e.unwrap=()=>e._zod.def.innerType});function Je(e){return new St({type:"optional",innerType:e})}const Ei=c("ZodNullable",(e,t)=>{Ro.init(e,t),I.init(e,t),e.unwrap=()=>e._zod.def.innerType});function He(e){return new Ei({type:"nullable",innerType:e})}const zi=c("ZodDefault",(e,t)=>{xo.init(e,t),I.init(e,t),e.unwrap=()=>e._zod.def.innerType,e.removeDefault=e.unwrap});function Si(e,t){return new zi({type:"default",innerType:e,get defaultValue(){return typeof t=="function"?t():t}})}const Zi=c("ZodPrefault",(e,t)=>{Oo.init(e,t),I.init(e,t),e.unwrap=()=>e._zod.def.innerType});function Ci(e,t){return new Zi({type:"prefault",innerType:e,get defaultValue(){return typeof t=="function"?t():t}})}const Zt=c("ZodNonOptional",(e,t)=>{Do.init(e,t),I.init(e,t),e.unwrap=()=>e._zod.def.innerType});function $i(e,t){return new Zt({type:"nonoptional",innerType:e,...m(t)})}const Ti=c("ZodCatch",(e,t)=>{Po.init(e,t),I.init(e,t),e.unwrap=()=>e._zod.def.innerType,e.removeCatch=e.unwrap});function Ii(e,t){return new Ti({type:"catch",innerType:e,catchValue:typeof t=="function"?t:()=>t})}const Ai=c("ZodPipe",(e,t)=>{No.init(e,t),I.init(e,t),e.in=t.in,e.out=t.out});function et(e,t){return new Ai({type:"pipe",in:e,out:t})}const Ri=c("ZodReadonly",(e,t)=>{Fo.init(e,t),I.init(e,t)});function xi(e){return new Ri({type:"readonly",innerType:e})}const Oi=c("ZodCustom",(e,t)=>{Lo.init(e,t),I.init(e,t)});function Di(e){const t=new P({check:"custom"});return t._zod.check=e,t}function Pi(e,t={}){return Ir(Oi,e,t)}function Ni(e){const t=Di(n=>(n.addIssue=o=>{if(typeof o=="string")n.issues.push(J(o,n.value,t._zod.def));else{const r=o;r.fatal&&(r.continue=!1),r.code??(r.code="custom"),r.input??(r.input=n.value),r.inst??(r.inst=t),r.continue??(r.continue=!t._zod.def.abort),n.issues.push(J(r))}},e(n.value,n)));return t}const Ct=[{id:"DYN001",title:"The Candle and the Pyre",rarity:"Common",tags:["Choice","Wager","Score"],text:`A moth whispers to you as it flutters by. 'Isn't the fire beautiful?' You have two choices:
- Catch the moth and gain two points now.
- Let it go, and for this round, every 'C' answer will earn you an extra point.`,choices:[{label:"Now",effect:{type:"IMMEDIATE_SCORE",value:2,flavorText:"You snatch the moth from the air. Its dust glitters on your fingers as you feel a surge of insight."}},{label:"Wait",effect:{type:"APPLY_WAGER",target:"answer-c",reward:{type:"SCORE",value:1},flavorText:"You let the moth spiral towards the flame. You feel a strange connection to its fate, tied to your future choices."}},{label:"Ignore"}]},{id:"DYN002",title:"Predictive Loop",rarity:"Uncommon",tags:["Prediction","Gamble","Score"],text:"Nous knows what you will choose. Do you? Predict which answer ('A', 'B', or 'C') you will select most frequently this round. If you are correct, your round score will be doubled.",choices:[{label:"Predict 'A'",effect:{type:"ROUND_PREDICTION",prediction:"A"}},{label:"Predict 'B'",effect:{type:"ROUND_PREDICTION",prediction:"B"}},{label:"Predict 'C'",effect:{type:"ROUND_PREDICTION",prediction:"C"}}],duration:"round",resolveAt:"endOfRound",reward:{type:"DOUBLE_ROUND_SCORE"}},{id:"DYN003",title:"The Forked Path",rarity:"Uncommon",tags:["Risk","Modifier","High-Stakes"],audacityMin:2,text:"The path splits. Choose your burden for this round. Survive, and gain a reward of 3 points.",choices:[{label:"Veil",effect:{type:"ROUND_MODIFIER",modifier:"VEIL",flavorText:"A fog clouds your vision. The answers become indistinct shapes."}},{label:"Weight",effect:{type:"ROUND_MODIFIER",modifier:"WEIGHT",flavorText:"Every misstep feels heavier. The thread groans under the strain."}}],duration:"round",resolveAt:"endOfRound",reward:{type:"SCORE",value:3}},{id:"DYN004",title:"The Tallyman's Gambit",rarity:"Uncommon",tags:["Gamble","Consequence","Pact"],text:"You accept the Tallyman's Gambit. Each time you answer 'C' this round, a tally is marked. The final count will determine your fate.",choices:[{label:"Accept",effect:{type:"TALLY_TABLE",target:"C",table:{0:{type:"DOUBLE_ROUND_SCORE"}}}}],duration:"round",resolveAt:"endOfRound"},{id:"DYN005",title:"Scholar's Boon",rarity:"Common",tags:["Utility","Safety"],text:`Scholar's Boon: Your knowledge protects you.
Gain +1 Thread at the start of this round.`,choices:[{label:"Accept Boon",effect:{type:"POWER_UP",power:"REMOVE_WRONG_ANSWER",flavorText:"You feel a quiet confidence. One of the wrong paths fades from view, leaving only certainty and a single doubt."}},{label:"Turn it down",effect:{type:"SCORE",value:-1}}]}],Fi=Object.freeze(Object.defineProperty({__proto__:null,default:Ct},Symbol.toStringTag,{value:"Module"})),Li=Ce({type:X()}).catchall(li()),Ui=Ce({label:X(),effect:Li.optional()}),Wi=Ce({id:X(),title:X(),text:X(),choices:Ze(Ui).max(3)}),Mi=Ze(Wi),_e=Mi.parse(Ct);let U=null,ve=[],we=0;function ji(){return U=_e[Math.floor(Math.random()*_e.length)],U}function Bi(){if(!U)return["","",""];const e=U.choices.map(t=>t.label||"");for(;e.length<3;)e.push("");return e.slice(0,3)}function qi(e){if(!U)return null;const t=U.choices[e];return t?.effect?(Yi(t.effect),U=null,t.effect?.flavorText||null):(U=null,null)}function Vi(e,t){let n=we,o=0,r=1;return ve.forEach(i=>{if(i.type==="APPLY_WAGER"){const s=i.target.split("-").pop().toUpperCase(),u=e[s]||0;i.reward&&i.reward.type==="SCORE"&&(o+=i.reward.value*u)}else if(i.type==="TALLY_TABLE"){const s=e[i.target]||0;if(i.table&&i.table[s]){const u=i.table[s];u.type==="DOUBLE_ROUND_SCORE"?r*=2:u.type==="SCORE"&&(n+=u.value)}}}),ve=[],we=0,{scoreDelta:n,roundScoreDelta:o,roundScoreMultiplier:r}}function Yi(e){e.type==="IMMEDIATE_SCORE"?we+=e.value:e.type==="ADD_CARD_TO_DECK"&&e.card?_e.push(e.card):ve.push(e)}typeof window<"u"&&(window.Fate={draw:ji,getButtonLabels:Bi,choose:qi,resolveRound:Vi});document.addEventListener("DOMContentLoaded",()=>{const e=document.getElementById("controller"),t=window.Fate||{};_.initialize(),w.currentState={};async function n(){await w.loadData(),await w.loadGame()?(_.updateDisplayValues(w.getState()),_.updateScreen(w.getState().currentScreen||"game-lobby")):(_.updateScreen("welcome"),r()),console.log("[INIT]: Nous initialized.")}e.addEventListener("click",l=>{const v=l.target.closest("button")?.dataset.action;v&&s(v)});function o(l){(l.key==="ArrowUp"||l.key==="ArrowDown"||l.key==="Enter")&&l.preventDefault(),l.key==="ArrowUp"?s("welcome-up"):l.key==="ArrowDown"?s("welcome-down"):l.key==="Enter"&&s("welcome-select")}function r(){document.addEventListener("keydown",o)}function i(){document.removeEventListener("keydown",o)}window.addEventListener("beforeunload",()=>{w.saveGame()});function s(l){switch(console.log(`[ACTION]: ${l}`),w.getState(),l){case"welcome-up":_.moveWelcomeSelection("up");break;case"welcome-down":_.moveWelcomeSelection("down");break;case"welcome-select":{const g=_.getWelcomeSelection();g==="Play"?s("start-game"):g==="Rules"?s("go-rules"):g==="Options"&&s("go-options");break}case"start-game":i(),_.showParticipantEntry();break;case"participants-up":_.adjustParticipantCount(1);break;case"participants-down":_.adjustParticipantCount(-1);break;case"participants-confirm":{const g=_.confirmParticipants();w.initializeGame(g),_.updateDisplayValues(w.getState()),setTimeout(()=>{_.updateScreen("game-lobby"),_.updateDisplayValues(w.getState())},2e3);break}case"go-rules":_.updateScreen("rules");break;case"go-options":_.updateScreen("options");break;case"back-to-welcome":_.updateScreen("welcome"),r();break;case"return-to-lobby":_.updateScreen("game-lobby");break;case"restart-game":console.log("[ACTION]: Restarting game (placeholder)."),_.updateScreen("welcome"),r();break;case"quit-game":console.log("[ACTION]: Quit game (placeholder).");break;case"save-reading":console.log("[ACTION]: Save reading (placeholder).");break;case"save-and-quit":w.saveGame(),_.updateScreen("welcome"),r();break;case"tempt-fate":{const g=t.draw();if(!g)break;w.setCurrentFateCard(g),_.showFateCard(g),_.showFateChoices(t.getButtonLabels()),_.updateScreen("fate-card");break}case"next-round":w.startNewRound(),_.updateDisplayValues(w.getState()),_.updateScreen("round-lobby");break;case"end-round":const p=w.cutThread();_.updateDisplayValues(w.getState());let v="";if(typeof t.resolveRound=="function"){const g={A:0,B:0,C:0};w.getState().answeredThisRound.forEach(x=>{g[x.letter]=(g[x.letter]||0)+1});const y=t.resolveRound(g,p);w.applyFateResults(y),w.resetRound();const A=[];if(y.roundScoreMultiplier&&y.roundScoreMultiplier!==1&&A.push(`round score x${y.roundScoreMultiplier}`),y.roundScoreDelta){const x=y.roundScoreDelta>0?"+":"";A.push(`${x}${y.roundScoreDelta} round pts`)}if(y.scoreDelta){const x=y.scoreDelta>0?"+":"";A.push(`${x}${y.scoreDelta} score`)}v=A.length?`Fate resolves: ${A.join(", ")}`:""}_.updateDisplayValues(w.getState()),p?_.updateScreen("game-lobby"):(_.showFailure(w.getState().roundScore),_.updateScreen("failure")),v&&_.showFateResult(v);break;case"double-points":w.spendThreadToWeave()?(w.shuffleNextCategory(),_.updateDisplayValues(w.getState())):console.log("[ACTION]: Not enough Thread to weave.");break;case"start-question":w.pullThread(),_.updateDisplayValues(w.getState());const h=w.getNextQuestion();h?(_.showQuestion({title:h.title,text:h.text,choices:{A:h.answers[0].text,B:h.answers[1].text,C:h.answers[2].text}}),_.updateScreen("question")):(alert("The thread has nothing left to reveal."),_.updateScreen("round-lobby"));break;case"answer-a":case"answer-b":case"answer-c":const d=l.split("-")[1].toUpperCase();u(d);break;case"fate-a":case"fate-b":case"fate-c":{const g={"fate-a":0,"fate-b":1,"fate-c":2},y=w.chooseFateOption(g[l]);_.showFateResult(y),_.updateDisplayValues(w.getState()),_.updateScreen("game-lobby");break}case"accept-result":_.updateDisplayValues(w.getState()),w.getState().thread<=0?(_.showFailure(w.getState().roundScore),w.endRound(!1),_.updateScreen("failure")):_.updateScreen("round-lobby");break;case"challenge-result":console.log("[ACTION]: Disagree triggered — increment Audacity (placeholder)."),_.updateScreen("round-lobby");break}}function u(l){const p=w.getState().currentQuestion?.questionId;p&&w.recordAnswer(p,l);const v=w.evaluateAnswer(l);v&&(_.showResult(v),_.updateScreen("result"))}n(),window.handleAction=s});export{Ze as a,li as b,Qi as n,Ce as o,X as s};
