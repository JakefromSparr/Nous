(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))o(r);new MutationObserver(r=>{for(const i of r)if(i.type==="childList")for(const a of i.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&o(a)}).observe(document,{childList:!0,subtree:!0});function n(r){const i={};return r.integrity&&(i.integrity=r.integrity),r.referrerPolicy&&(i.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?i.credentials="include":r.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function o(r){if(r.ep)return;r.ep=!0;const i=n(r);fetch(r.href,i)}})();const Ot="modulepreload",Dt=function(e){return"/Nous/"+e},Ce={},V=function(t,n,o){let r=Promise.resolve();if(n&&n.length>0){let d=function(f){return Promise.all(f.map(v=>Promise.resolve(v).then(h=>({status:"fulfilled",value:h}),h=>({status:"rejected",reason:h}))))};document.getElementsByTagName("link");const a=document.querySelector("meta[property=csp-nonce]"),c=a?.nonce||a?.getAttribute("nonce");r=d(n.map(f=>{if(f=Dt(f),f in Ce)return;Ce[f]=!0;const v=f.endsWith(".css"),h=v?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${f}"]${h}`))return;const p=document.createElement("link");if(p.rel=v?"stylesheet":Ot,v||(p.as="script"),p.crossOrigin="",p.href=f,c&&p.setAttribute("nonce",c),document.head.appendChild(p),v)return new Promise((_,b)=>{p.addEventListener("load",_),p.addEventListener("error",()=>b(new Error(`Unable to preload CSS for ${f}`)))})}))}function i(a){const c=new Event("vite:preloadError",{cancelable:!0});if(c.payload=a,window.dispatchEvent(c),!c.defaultPrevented)throw a}return r.then(a=>{for(const c of a||[])c.status==="rejected"&&i(c.reason);return t().catch(i)})};let ce,Te,Ae;const Pt=(()=>{let e=[],t=null,n=[],o={currentScreen:"welcome",lives:0,score:0,roundsToWin:3,roundsWon:0,roundNumber:1,roundScore:0,thread:0,audacity:0,difficultyLevel:1,correctAnswersThisDifficulty:0,answeredQuestionIds:new Set,completedFateCardIds:new Set,activeRoundEffects:[],currentFateCard:null,pendingFateCard:null,activeFateCard:null,currentQuestion:null,currentAnswers:[],notWrongCount:0,currentCategory:"Mind, Past",roundAnswerTally:{A:0,B:0,C:0},traits:{X:0,Y:0,Z:0},activePowerUps:[],answeredThisRound:[],fateCardDeck:[],questionDeck:[]};typeof window<"u"&&(ce=window.CLASS_SCORES,Te=window.CLASS_TRAIT_BASE,Ae=window.TRAIT_LOADINGS);const r=async()=>{try{const[{default:u},g]=await Promise.all([V(()=>Promise.resolve().then(()=>Ui),void 0),V(()=>import("./questions-BAxrD2KR.js"),[]).catch(()=>V(()=>import("./questions-BmAxWREq.js"),[])).catch(()=>V(()=>import("./questionDeck-CIvgfmgs.js"),[]))]),w=g.default??g,y=Array.isArray(w.questions)?w.questions:w;n=[...u],e=[...y],o.fateCardDeck=[...u],o.questionDeck=[...y],typeof QuestionEngine<"u"?(QuestionEngine.setDefaultDeck(e),t=new QuestionEngine(e)):t={nextQuestion:()=>e[0]||null,resolve:()=>({})}}catch(u){console.error("[LOAD DATA]",u),n=[],e=[{questionId:"T1",title:"Q1",text:"T1",answers:[{text:"A",answerClass:"Typical",explanation:""},{text:"B",answerClass:"Revelatory",explanation:""},{text:"C",answerClass:"Wrong",explanation:""}]}],o.fateCardDeck=[],o.questionDeck=[...e],typeof QuestionEngine<"u"?(QuestionEngine.setDefaultDeck(e),t=new QuestionEngine(e)):t={nextQuestion:()=>e[0]||null,resolve:()=>({})}}},i=(u=1)=>{o={...o,lives:u+1,score:0,roundsWon:0,roundNumber:1,roundScore:0,thread:4,audacity:0,difficultyLevel:1,correctAnswersThisDifficulty:0,answeredQuestionIds:new Set,completedFateCardIds:new Set,activeRoundEffects:[],currentFateCard:null,pendingFateCard:null,activeFateCard:null,currentQuestion:null,currentAnswers:[],notWrongCount:0,currentCategory:"Mind, Past",roundAnswerTally:{A:0,B:0,C:0},traits:{X:0,Y:0,Z:0},activePowerUps:[],answeredThisRound:[],fateCardDeck:o.fateCardDeck,questionDeck:o.questionDeck}},a=()=>{o.roundNumber++,o.roundScore=0;const u=o.roundsToWin-o.roundsWon;o.thread=u+1,o.notWrongCount=0,o.activeRoundEffects=[],o.roundAnswerTally={A:0,B:0,C:0},o.activePowerUps=[],o.answeredThisRound=[],o.currentFateCard=null,o.currentCategory="Mind, Past",o.currentAnswers=[],o.activeFateCard=o.pendingFateCard,o.activeFateCard&&(o.activeFateCard.id==="DYN005"||o.activeFateCard.id==="DYN004")&&o.activeFateCard.id==="DYN005"&&o.thread++,o.pendingFateCard=null},c=(u="lose")=>{switch(C(),u){case"win":o.roundsWon++,o.score+=o.roundScore;break;case"lose":o.lives--;break;case"escape":o.score+=o.roundScore,o.roundScore=0;break}},d=()=>o.thread>0?(o.thread--,!0):!1,f=()=>{o.thread--},v=()=>(c("escape"),!0),h=()=>{const u=["Mind, Present","Body, Future","Soul, Past"];o.currentCategory=u[Math.floor(Math.random()*u.length)]},p=()=>{o.difficultyLevel<3&&(o.difficultyLevel++,o.correctAnswersThisDifficulty=0,console.log(`[DIFFICULTY]: Advanced to level ${o.difficultyLevel}`))},_=()=>{if(o.pendingFateCard)return console.log("[FATE]: A fate is already pending."),null;const u=n;if(u.length===0)return console.warn("[FATE]: Deck is empty"),null;const g=u[Math.floor(Math.random()*u.length)];return o.pendingFateCard=g,g},b=u=>{o.currentFateCard=u},$=()=>o.currentFateCard,A=u=>{const g=o.currentFateCard;if(!g)return null;const w=g.choices[u];if(!w)return null;const y=D({...w.effect},g.title);return o.completedFateCardIds.add(g.id),o.currentFateCard=null,y},D=(u,g="")=>{if(!u)return null;switch(u.type){case"IMMEDIATE_SCORE":o.score+=u.value;break;case"SCORE":o.roundScore+=u.value;break;case"POWER_UP":o.activePowerUps.push(u.power);break;default:o.activeRoundEffects.push({...u,cardTitle:g,count:0});break}return u.flavorText||null},C=()=>{o.activeRoundEffects.forEach(u=>{switch(u.type){case"ROUND_PREDICTION":{const g=o.roundAnswerTally,w=Object.entries(g).sort((y,P)=>P[1]-y[1])[0];w&&w[1]>0&&w[0]===u.prediction&&u.reward&&(u.reward.type==="DOUBLE_ROUND_SCORE"?o.roundScore*=2:u.reward.type==="SCORE"&&(o.score+=u.reward.value));break}case"ROUND_MODIFIER":u.reward&&o.thread>0&&u.reward.type==="SCORE"&&(o.score+=u.reward.value);break;case"TALLY_ANSWERS":u.count&&u.count>0&&(o.score+=u.count);break}}),o.activeRoundEffects=[],o.roundAnswerTally={A:0,B:0,C:0}},k=u=>{for(let g=u.length-1;g>0;g--){const w=Math.floor(Math.random()*(g+1));[u[g],u[w]]=[u[w],u[g]]}};return{loadData:r,initializeGame:i,startNewRound:a,endRound:c,spendThreadToWeave:d,pullThread:f,cutThread:v,shuffleNextCategory:h,getState:()=>({...o}),drawFateCard:_,applyFateCardEffect:D,setCurrentFateCard:b,getCurrentFateCard:$,chooseFateOption:A,getNextQuestion:()=>{if(!t)return console.warn("[QUESTION]: Engine unavailable"),null;const u=t.nextQuestion();if(!u)return console.warn("[QUESTION]: Deck exhausted"),null;if(o.currentQuestion=u,o.currentAnswers=u.answers.slice(),k(o.currentAnswers),o.activePowerUps.includes("REMOVE_WRONG_ANSWER")){const g=o.currentAnswers.findIndex(w=>w.answerClass==="Wrong");g!==-1&&o.currentAnswers.splice(g,1),o.activePowerUps=o.activePowerUps.filter(w=>w!=="REMOVE_WRONG_ANSWER")}return{...o.currentQuestion,answers:o.currentAnswers}},evaluateAnswer:u=>{o.roundAnswerTally[u]=(o.roundAnswerTally[u]||0)+1,o.activeRoundEffects.forEach(R=>{R.type==="APPLY_WAGER"&&`answer-${u.toLowerCase()}`===R.target?R.reward.type==="SCORE"&&(o.score+=R.reward.value):R.type==="TALLY_ANSWERS"&&u.toUpperCase()===R.target.toUpperCase()&&(R.count=(R.count||0)+1)});const g=o.currentQuestion;if(!g)return console.warn("[EVAL]: No current question"),null;o.answeredQuestionIds.add(g.questionId);const y={A:0,B:1,C:2}[u]??0,P=o.currentAnswers[y];t&&t.resolve(g.questionId,y,{points:0,thread:0,traits:{}});const O=P.answerClass;let q=O!=="Wrong",se=ce[O]?.thread??0,ze=ce[O]?.points??0;q&&(o.notWrongCount++,o.correctAnswersThisDifficulty++);const At=Te[O],Ze=Ae[g.questionId]||{},Rt=Ze.axisWeight||{},$e=Ze.overrides?.[O]||{};if(["X","Y","Z"].forEach(R=>{const xt=R in $e?$e[R]:At[R]*(Rt[R]??1);o.traits[R]=Math.max(-9,Math.min(9,(o.traits[R]||0)+xt))}),o.activeFateCard)switch(o.activeFateCard.id){case"DYN001":q||(se-=1);break;case"DYN002":q&&O==="Revelatory"&&(ze+=1);break}return o.thread+=se,o.roundScore+=ze,o.correctAnswersThisDifficulty>3&&p(),o.notWrongCount>=3&&(o.roundPassed=!0),{correct:q,question:g.text,answer:P.text,explanation:P.explanation,outcomeText:q?"The thread holds.":`The thread frays by ${Math.abs(se)}`}},incrementAudacity:()=>{o.audacity++},loseRoundPoints:()=>{o.roundScore=0},hasWonGame:()=>o.roundsWon>=o.roundsToWin,isOutOfLives:()=>o.lives<=0,saveGame:()=>{try{return localStorage.setItem("nous-save",JSON.stringify(o)),!0}catch(u){return console.error("[SAVE]",u),!1}},loadGame:async()=>{try{const u=localStorage.getItem("nous-save");if(!u)return!1;const g=JSON.parse(u),{validateGameState:w}=await V(async()=>{const{validateGameState:y}=await import("./validator-DeFBgwlM.js");return{validateGameState:y}},[]);try{w(g)}catch(y){return console.error("[LOAD VALIDATION]",y),!1}return o={...o,...g},!0}catch(u){return console.error("[LOAD]",u),!1}},recordAnswer:(u,g)=>{o.answeredThisRound.push({qid:u,letter:g})},resetRound:()=>{o.answeredThisRound=[],o.activeRoundEffects=[]},applyFateResults:(u={})=>{if(!u)return;const{scoreDelta:g=0,roundScoreDelta:w=0,roundScoreMultiplier:y=1}=u;o.score+=g,o.roundScore+=w,o.roundScore*=y}}})();typeof window<"u"&&(window.State=Pt);const Nt=new Set(["start-game","go-rules","go-options","back-to-welcome","save-and-quit","tempt-fate","next-round","end-round","double-points","start-question","answer-a","answer-b","answer-c","challenge-result","accept-result","return-to-lobby","restart-game","save-reading","quit-game","welcome-up","welcome-down","welcome-select","participants-up","participants-confirm","participants-down","fate-a","fate-b","fate-c"]),He={welcome:[{label:"Up",action:"welcome-up"},{label:"Select",action:"welcome-select"},{label:"Down",action:"welcome-down"}],rules:[{label:"Back",action:"back-to-welcome"},null,null],options:[{label:"Back",action:"back-to-welcome"},null,null],participants:[{label:"More",action:"participants-up"},{label:"Confirm",action:"participants-confirm"},{label:"Less",action:"participants-down"}],"game-lobby":[{label:"Turn Back",action:"save-and-quit"},{label:"Tempt Fate",action:"tempt-fate"},{label:"Press On",action:"next-round"}],"round-lobby":[{label:"Cut the Thread",action:"end-round"},{label:"Weave it to Fate",action:"double-points"},{label:"Pull the Thread",action:"start-question"}],question:[{label:"Choose A",action:"answer-a"},{label:"Choose B",action:"answer-b"},{label:"Choose C",action:"answer-c"}],"fate-card":[{label:"Choose A",action:"fate-a"},{label:"Choose B",action:"fate-b"},{label:"Choose C",action:"fate-c"}],result:[{label:"Disagree",action:"challenge-result"},{label:"Outcome",action:"",disabled:!0},{label:"Accept",action:"accept-result"}],failure:[{label:"[Logo]",action:"",disabled:!0},{label:"Return to Lobby",action:"return-to-lobby"},{label:"[Logo]",action:"",disabled:!0}],"final-reading":[{label:"Restart",action:"restart-game"},{label:"Save Reading",action:"save-reading"},{label:"Quit",action:"quit-game"}]};function Ut(e){for(const t in e)e[t].forEach((n,o)=>{n&&n.action&&!Nt.has(n.action)&&console.warn(`⚠️ Invalid action '${n.action}' on button ${o+1} for screen '${t}'`)})}Ut(He);const Ft=(()=>{const e=document.getElementById("app-container"),t=document.getElementById("controller"),n=document.getElementById("last-change"),o=document.getElementById("aria-status"),r={btn1:document.getElementById("btn-1"),btn2:document.getElementById("btn-2"),btn3:document.getElementById("btn-3")};r.btn1.querySelector(".button-label"),r.btn2.querySelector(".button-label"),r.btn3.querySelector(".button-label");const i=document.querySelectorAll(".game-screen"),a=Array.from(document.querySelectorAll("#welcome-options li"));let c=0;const d=()=>{a.forEach((l,u)=>{l.classList.toggle("selected",u===c)}),o&&(o.textContent=v())},f=l=>{l==="up"?c=(c-1+a.length)%a.length:l==="down"&&(c=(c+1)%a.length),d()},v=()=>{const l=a[c];return l?l.textContent.replace(/^\s*[^A-Za-z0-9]*/,"").trim():""},h=l=>{e.classList.add("is-transitioning"),setTimeout(()=>{i.forEach(g=>{g.classList.remove("is-active"),g.setAttribute("aria-hidden","true")});const u=document.querySelector(`[data-screen="${l}"]`);u&&(u.classList.add("is-active"),u.setAttribute("aria-hidden","false")),e.setAttribute("data-game-state",l),t.setAttribute("data-controller-state",l),n&&(n.textContent=`Last state: ${l}`),o&&(o.textContent=l.replace("-"," ")),p(l),l==="welcome"&&d(),e.classList.remove("is-transitioning")},700)},p=l=>{const u=He[l]||[];["btn1","btn2","btn3"].forEach((g,w)=>{const y=r[g],P=y.querySelector(".button-label"),O=u[w];O&&P?(P.innerText=O.label,y.disabled=!!O.disabled,y.setAttribute("data-action",O.action||"")):P&&(P.innerText="",y.disabled=!0,y.removeAttribute("data-action"))})},_=l=>{["btn1","btn2","btn3"].forEach((u,g)=>{const w=r[u],y=l[g]||"";w.querySelector(".button-label").innerText=y||" ",w.disabled=y==="",w.classList.toggle("hidden",y==="")})},b=document.getElementById("participant-count-display"),$=document.getElementById("participant-flavor");let A=1;const D=()=>{b.textContent=A},C=()=>{A=1,$.hidden=!0,D(),h("participants")},k=l=>{A=Math.min(20,Math.max(1,A+l)),D()},z=()=>A,N=()=>{const l=A;return $.textContent=`Strange... it looks like there are ${l+1} of you here. Ah well.`,$.hidden=!1,l},F=l=>{if("lives"in l&&(document.getElementById("lives-display").textContent=l.lives),"roundsToWin"in l&&"roundsWon"in l){const u=l.roundsToWin-l.roundsWon;document.getElementById("rounds-display").textContent=u}if("score"in l&&(document.getElementById("score-display").textContent=l.score),"thread"in l&&(document.getElementById("thread-display").textContent=l.thread),"roundScore"in l&&(document.getElementById("round-score").textContent=l.roundScore),"roundNumber"in l&&(document.getElementById("round-number-display").textContent=l.roundNumber),"currentCategory"in l&&(document.getElementById("category-hint").textContent=l.currentCategory),"activeRoundEffects"in l){const u=document.querySelector("#divinations-display p"),g=l.activeRoundEffects.map(w=>w.cardTitle).filter(Boolean);u.textContent=g.length?g.join(", "):"[None]"}},B=l=>{document.getElementById("question-title").textContent=l.title||"",document.getElementById("question-text").textContent=l.text||"",document.getElementById("answer-a").textContent=l.choices?.A||"",document.getElementById("answer-b").textContent=l.choices?.B||"",document.getElementById("answer-c").textContent=l.choices?.C||""},j=l=>{document.querySelector("#fate-card-title").textContent=l.title,document.querySelector("#fate-card-text").textContent=l.text};return{updateScreen:h,configureButtons:p,updateDisplayValues:F,showQuestion:B,setButtonLabels:_,showResult:l=>{document.getElementById("result-header").textContent=l.correct?"Correct":"Incorrect",document.getElementById("result-question").textContent=l.question,document.getElementById("result-chosen-answer").textContent=l.answer,document.getElementById("result-explanation").textContent=l.explanation,document.getElementById("result-outcome-message").textContent=l.outcomeText},showFailure:l=>{document.getElementById("lost-points-display").textContent=l},showFate:l=>{j(l)},showFateCard:j,showFateChoices:(l=[])=>{const u=document.querySelectorAll("#controller button");for(;l.length<3;)l.push("");u.forEach((g,w)=>{const y=l[w]||"";g.querySelector(".button-label").textContent=y||" ",g.disabled=!y,g.classList.toggle("hidden",!y)})},showFateResult:l=>{l&&(alert(l),console.log(`[FATE RESULT]: ${l}`))},showParticipantEntry:C,adjustParticipantCount:k,getParticipantCount:z,confirmParticipants:N,moveWelcomeSelection:f,getWelcomeSelection:v}})();typeof window<"u"&&(window.UI=Ft);const et={Typical:{points:2,thread:0},Revelatory:{points:1,thread:1},Wrong:{points:0,thread:-1}},Lt={Typical:{X:1,Y:0,Z:-1},Revelatory:{X:0,Y:2,Z:1},Wrong:{X:-1,Y:-1,Z:0}},tt={Typical:{X:-1,Y:-1,Z:-1},Revelatory:{X:2,Y:3,Z:2},Wrong:{X:-2,Y:-2,Z:-2}};typeof window<"u"&&(window.CLASS_SCORES=et,window.TRAIT_MAP=Lt,window.CLASS_TRAIT_BASE=tt);const nt={101:{axisWeight:{Z:0}},103:{axisWeight:{Z:0}},104:{axisWeight:{Z:.5}},105:{axisWeight:{Z:0}},106:{axisWeight:{Z:0}},107:{axisWeight:{Z:.5}},108:{axisWeight:{Z:1.5},overrides:{Typical:{Z:-3},Revelatory:{X:-1,Y:0,Z:2},Wrong:{X:-2,Y:1,Z:1}}},109:{axisWeight:{Z:1.5}},201:{axisWeight:{Z:0}},202:{axisWeight:{Z:1.5}},203:{axisWeight:{Z:0}},204:{axisWeight:{Z:0}},205:{axisWeight:{X:.5,Y:.7,Z:1.2},overrides:{Typical:{X:1,Y:-2,Z:-2},Revelatory:{X:-2,Y:4,Z:2},Wrong:{X:-2,Y:1,Z:-3}}},206:{axisWeight:{Z:1}},207:{axisWeight:{Z:1.5}},208:{},209:{axisWeight:{Z:0}}};typeof window<"u"&&(window.TRAIT_LOADINGS=nt);let Wt=[];function Re(e){for(let t=e.length-1;t>0;t--){const n=Math.floor(Math.random()*(t+1));[e[t],e[n]]=[e[n],e[t]]}return e}let Mt=class{constructor(t=Wt){this.tier="Tier1",this.answered=new Set,this.drawnThisTier=0,this.deck=Array.isArray(t)?t.filter(n=>Array.isArray(n.answers)&&n.answers.length>=3):[],this.pools={Tier1:this.deck.filter(n=>n.difficultyTier==="Tier1"),Tier2:this.deck.filter(n=>n.difficultyTier==="Tier2"),Tier3:this.deck.filter(n=>n.difficultyTier==="Tier3")}}nextQuestion(){const t=this.tier==="Tier3"?["Tier3","Tier2","Tier1"]:this.tier==="Tier2"?["Tier2","Tier1"]:["Tier1"];for(const n of t){const o=this.pools[n].filter(r=>!this.answered.has(r.questionId));if(o.length){const r=Re(o)[0];return this.randomizeAnswers(r),r}}return null}randomizeAnswers(t){t.answers=Re([...t.answers])}resolve(t,n,o){const i=this.deck.find(p=>p.questionId===t).answers[n],{points:a,thread:c}=et[i.answerClass];o.points+=a,o.thread+=c;const d=tt[i.answerClass],f=nt[t]||{},v=f.axisWeight||{},h=f.overrides?.[i.answerClass]||{};return["X","Y","Z"].forEach(p=>{const _=p in h?h[p]:d[p]*(v[p]??1);o.traits[p]=Math.max(-9,Math.min(9,(o.traits[p]||0)+_))}),this.answered.add(t),this.drawnThisTier++,(this.drawnThisTier>=4||!this.pools[this.tier].some(p=>!this.answered.has(p.questionId)))&&this.tier!=="Tier3"&&(this.drawnThisTier=0,this.tier=this.tier==="Tier1"?"Tier2":"Tier3"),i}};typeof window<"u"&&(window.QuestionEngine=Mt);function s(e,t,n){function o(c,d){var f;Object.defineProperty(c,"_zod",{value:c._zod??{},enumerable:!1}),(f=c._zod).traits??(f.traits=new Set),c._zod.traits.add(e),t(c,d);for(const v in a.prototype)v in c||Object.defineProperty(c,v,{value:a.prototype[v].bind(c)});c._zod.constr=a,c._zod.def=d}const r=n?.Parent??Object;class i extends r{}Object.defineProperty(i,"name",{value:e});function a(c){var d;const f=n?.Parent?new i:this;o(f,c),(d=f._zod).deferred??(d.deferred=[]);for(const v of f._zod.deferred)v();return f}return Object.defineProperty(a,"init",{value:o}),Object.defineProperty(a,Symbol.hasInstance,{value:c=>n?.Parent&&c instanceof n.Parent?!0:c?._zod?.traits?.has(e)}),Object.defineProperty(a,"name",{value:e}),a}class X extends Error{constructor(){super("Encountered Promise during synchronous parse. Use .parseAsync() instead.")}}const ot={};function L(e){return ot}function jt(e){const t=Object.values(e).filter(o=>typeof o=="number");return Object.entries(e).filter(([o,r])=>t.indexOf(+o)===-1).map(([o,r])=>r)}function Bt(e,t){return typeof t=="bigint"?t.toString():t}function rt(e){return{get value(){{const t=e();return Object.defineProperty(this,"value",{value:t}),t}}}}function ve(e){return e==null}function we(e){const t=e.startsWith("^")?1:0,n=e.endsWith("$")?e.length-1:e.length;return e.slice(t,n)}function qt(e,t){const n=(e.toString().split(".")[1]||"").length,o=(t.toString().split(".")[1]||"").length,r=n>o?n:o,i=Number.parseInt(e.toFixed(r).replace(".","")),a=Number.parseInt(t.toFixed(r).replace(".",""));return i%a/10**r}function S(e,t,n){Object.defineProperty(e,t,{get(){{const o=n();return e[t]=o,o}},set(o){Object.defineProperty(e,t,{value:o})},configurable:!0})}function be(e,t,n){Object.defineProperty(e,t,{value:n,writable:!0,enumerable:!0,configurable:!0})}function Y(e){return JSON.stringify(e)}const it=Error.captureStackTrace?Error.captureStackTrace:(...e)=>{};function de(e){return typeof e=="object"&&e!==null&&!Array.isArray(e)}const Vt=rt(()=>{if(typeof navigator<"u"&&navigator?.userAgent?.includes("Cloudflare"))return!1;try{const e=Function;return new e(""),!0}catch{return!1}});function pe(e){if(de(e)===!1)return!1;const t=e.constructor;if(t===void 0)return!0;const n=t.prototype;return!(de(n)===!1||Object.prototype.hasOwnProperty.call(n,"isPrototypeOf")===!1)}const Yt=new Set(["string","number","symbol"]);function re(e){return e.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}function M(e,t,n){const o=new e._zod.constr(t??e._zod.def);return(!t||n?.parent)&&(o._zod.parent=e),o}function m(e){const t=e;if(!t)return{};if(typeof t=="string")return{error:()=>t};if(t?.message!==void 0){if(t?.error!==void 0)throw new Error("Cannot specify both `message` and `error` params");t.error=t.message}return delete t.message,typeof t.error=="string"?{...t,error:()=>t.error}:t}function Gt(e){return Object.keys(e).filter(t=>e[t]._zod.optin==="optional"&&e[t]._zod.optout==="optional")}const Qt={safeint:[Number.MIN_SAFE_INTEGER,Number.MAX_SAFE_INTEGER],int32:[-2147483648,2147483647],uint32:[0,4294967295],float32:[-34028234663852886e22,34028234663852886e22],float64:[-Number.MAX_VALUE,Number.MAX_VALUE]};function Xt(e,t){const n={},o=e._zod.def;for(const r in t){if(!(r in o.shape))throw new Error(`Unrecognized key: "${r}"`);t[r]&&(n[r]=o.shape[r])}return M(e,{...e._zod.def,shape:n,checks:[]})}function Kt(e,t){const n={...e._zod.def.shape},o=e._zod.def;for(const r in t){if(!(r in o.shape))throw new Error(`Unrecognized key: "${r}"`);t[r]&&delete n[r]}return M(e,{...e._zod.def,shape:n,checks:[]})}function Jt(e,t){if(!pe(t))throw new Error("Invalid input to extend: expected a plain object");const n={...e._zod.def,get shape(){const o={...e._zod.def.shape,...t};return be(this,"shape",o),o},checks:[]};return M(e,n)}function Ht(e,t){return M(e,{...e._zod.def,get shape(){const n={...e._zod.def.shape,...t._zod.def.shape};return be(this,"shape",n),n},catchall:t._zod.def.catchall,checks:[]})}function en(e,t,n){const o=t._zod.def.shape,r={...o};if(n)for(const i in n){if(!(i in o))throw new Error(`Unrecognized key: "${i}"`);n[i]&&(r[i]=e?new e({type:"optional",innerType:o[i]}):o[i])}else for(const i in o)r[i]=e?new e({type:"optional",innerType:o[i]}):o[i];return M(t,{...t._zod.def,shape:r,checks:[]})}function tn(e,t,n){const o=t._zod.def.shape,r={...o};if(n)for(const i in n){if(!(i in r))throw new Error(`Unrecognized key: "${i}"`);n[i]&&(r[i]=new e({type:"nonoptional",innerType:o[i]}))}else for(const i in o)r[i]=new e({type:"nonoptional",innerType:o[i]});return M(t,{...t._zod.def,shape:r,checks:[]})}function G(e,t=0){for(let n=t;n<e.issues.length;n++)if(e.issues[n]?.continue!==!0)return!0;return!1}function ye(e,t){return t.map(n=>{var o;return(o=n).path??(o.path=[]),n.path.unshift(e),n})}function H(e){return typeof e=="string"?e:e?.message}function W(e,t,n){const o={...e,path:e.path??[]};if(!e.message){const r=H(e.inst?._zod.def?.error?.(e))??H(t?.error?.(e))??H(n.customError?.(e))??H(n.localeError?.(e))??"Invalid input";o.message=r}return delete o.inst,delete o.continue,t?.reportInput||delete o.input,o}function ke(e){return Array.isArray(e)?"array":typeof e=="string"?"string":"unknown"}function K(...e){const[t,n,o]=e;return typeof t=="string"?{message:t,code:"custom",input:n,inst:o}:{...t}}const at=(e,t)=>{e.name="$ZodError",Object.defineProperty(e,"_zod",{value:e._zod,enumerable:!1}),Object.defineProperty(e,"issues",{value:t,enumerable:!1}),Object.defineProperty(e,"message",{get(){return JSON.stringify(t,Bt,2)},enumerable:!0}),Object.defineProperty(e,"toString",{value:()=>e.message,enumerable:!1})},st=s("$ZodError",at),ct=s("$ZodError",at,{Parent:Error});function nn(e,t=n=>n.message){const n={},o=[];for(const r of e.issues)r.path.length>0?(n[r.path[0]]=n[r.path[0]]||[],n[r.path[0]].push(t(r))):o.push(t(r));return{formErrors:o,fieldErrors:n}}function on(e,t){const n=t||function(i){return i.message},o={_errors:[]},r=i=>{for(const a of i.issues)if(a.code==="invalid_union"&&a.errors.length)a.errors.map(c=>r({issues:c}));else if(a.code==="invalid_key")r({issues:a.issues});else if(a.code==="invalid_element")r({issues:a.issues});else if(a.path.length===0)o._errors.push(n(a));else{let c=o,d=0;for(;d<a.path.length;){const f=a.path[d];d===a.path.length-1?(c[f]=c[f]||{_errors:[]},c[f]._errors.push(n(a))):c[f]=c[f]||{_errors:[]},c=c[f],d++}}};return r(e),o}const rn=e=>(t,n,o,r)=>{const i=o?Object.assign(o,{async:!1}):{async:!1},a=t._zod.run({value:n,issues:[]},i);if(a instanceof Promise)throw new X;if(a.issues.length){const c=new(r?.Err??e)(a.issues.map(d=>W(d,i,L())));throw it(c,r?.callee),c}return a.value},an=e=>async(t,n,o,r)=>{const i=o?Object.assign(o,{async:!0}):{async:!0};let a=t._zod.run({value:n,issues:[]},i);if(a instanceof Promise&&(a=await a),a.issues.length){const c=new(r?.Err??e)(a.issues.map(d=>W(d,i,L())));throw it(c,r?.callee),c}return a.value},ut=e=>(t,n,o)=>{const r=o?{...o,async:!1}:{async:!1},i=t._zod.run({value:n,issues:[]},r);if(i instanceof Promise)throw new X;return i.issues.length?{success:!1,error:new(e??st)(i.issues.map(a=>W(a,r,L())))}:{success:!0,data:i.value}},sn=ut(ct),lt=e=>async(t,n,o)=>{const r=o?Object.assign(o,{async:!0}):{async:!0};let i=t._zod.run({value:n,issues:[]},r);return i instanceof Promise&&(i=await i),i.issues.length?{success:!1,error:new e(i.issues.map(a=>W(a,r,L())))}:{success:!0,data:i.value}},cn=lt(ct),un=/^[cC][^\s-]{8,}$/,ln=/^[0-9a-z]+$/,dn=/^[0-9A-HJKMNP-TV-Za-hjkmnp-tv-z]{26}$/,pn=/^[0-9a-vA-V]{20}$/,hn=/^[A-Za-z0-9]{27}$/,fn=/^[a-zA-Z0-9_-]{21}$/,mn=/^P(?:(\d+W)|(?!.*W)(?=\d|T\d)(\d+Y)?(\d+M)?(\d+D)?(T(?=\d)(\d+H)?(\d+M)?(\d+([.,]\d+)?S)?)?)$/,gn=/^([0-9a-fA-F]{8}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{12})$/,xe=e=>e?new RegExp(`^([0-9a-fA-F]{8}-[0-9a-fA-F]{4}-${e}[0-9a-fA-F]{3}-[89abAB][0-9a-fA-F]{3}-[0-9a-fA-F]{12})$`):/^([0-9a-fA-F]{8}-[0-9a-fA-F]{4}-[1-8][0-9a-fA-F]{3}-[89abAB][0-9a-fA-F]{3}-[0-9a-fA-F]{12}|00000000-0000-0000-0000-000000000000)$/,_n=/^(?!\.)(?!.*\.\.)([A-Za-z0-9_'+\-\.]*)[A-Za-z0-9_+-]@([A-Za-z0-9][A-Za-z0-9\-]*\.)+[A-Za-z]{2,}$/,vn="^(\\p{Extended_Pictographic}|\\p{Emoji_Component})+$";function wn(){return new RegExp(vn,"u")}const bn=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])$/,yn=/^(([0-9a-fA-F]{1,4}:){7}[0-9a-fA-F]{1,4}|::|([0-9a-fA-F]{1,4})?::([0-9a-fA-F]{1,4}:?){0,6})$/,kn=/^((25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\/([0-9]|[1-2][0-9]|3[0-2])$/,Sn=/^(([0-9a-fA-F]{1,4}:){7}[0-9a-fA-F]{1,4}|::|([0-9a-fA-F]{1,4})?::([0-9a-fA-F]{1,4}:?){0,6})\/(12[0-8]|1[01][0-9]|[1-9]?[0-9])$/,In=/^$|^(?:[0-9a-zA-Z+/]{4})*(?:(?:[0-9a-zA-Z+/]{2}==)|(?:[0-9a-zA-Z+/]{3}=))?$/,dt=/^[A-Za-z0-9_-]*$/,En=/^([a-zA-Z0-9-]+\.)*[a-zA-Z0-9-]+$/,zn=/^\+(?:[0-9]){6,14}[0-9]$/,pt="(?:(?:\\d\\d[2468][048]|\\d\\d[13579][26]|\\d\\d0[48]|[02468][048]00|[13579][26]00)-02-29|\\d{4}-(?:(?:0[13578]|1[02])-(?:0[1-9]|[12]\\d|3[01])|(?:0[469]|11)-(?:0[1-9]|[12]\\d|30)|(?:02)-(?:0[1-9]|1\\d|2[0-8])))",Zn=new RegExp(`^${pt}$`);function ht(e){const t="(?:[01]\\d|2[0-3]):[0-5]\\d";return typeof e.precision=="number"?e.precision===-1?`${t}`:e.precision===0?`${t}:[0-5]\\d`:`${t}:[0-5]\\d\\.\\d{${e.precision}}`:`${t}(?::[0-5]\\d(?:\\.\\d+)?)?`}function $n(e){return new RegExp(`^${ht(e)}$`)}function Cn(e){const t=ht({precision:e.precision}),n=["Z"];e.local&&n.push(""),e.offset&&n.push("([+-]\\d{2}:\\d{2})");const o=`${t}(?:${n.join("|")})`;return new RegExp(`^${pt}T(?:${o})$`)}const Tn=e=>{const t=e?`[\\s\\S]{${e?.minimum??0},${e?.maximum??""}}`:"[\\s\\S]*";return new RegExp(`^${t}$`)},An=/^\d+$/,Rn=/^-?\d+(?:\.\d+)?/i,xn=/^[^A-Z]*$/,On=/^[^a-z]*$/,x=s("$ZodCheck",(e,t)=>{var n;e._zod??(e._zod={}),e._zod.def=t,(n=e._zod).onattach??(n.onattach=[])}),ft={number:"number",bigint:"bigint",object:"date"},mt=s("$ZodCheckLessThan",(e,t)=>{x.init(e,t);const n=ft[typeof t.value];e._zod.onattach.push(o=>{const r=o._zod.bag,i=(t.inclusive?r.maximum:r.exclusiveMaximum)??Number.POSITIVE_INFINITY;t.value<i&&(t.inclusive?r.maximum=t.value:r.exclusiveMaximum=t.value)}),e._zod.check=o=>{(t.inclusive?o.value<=t.value:o.value<t.value)||o.issues.push({origin:n,code:"too_big",maximum:t.value,input:o.value,inclusive:t.inclusive,inst:e,continue:!t.abort})}}),gt=s("$ZodCheckGreaterThan",(e,t)=>{x.init(e,t);const n=ft[typeof t.value];e._zod.onattach.push(o=>{const r=o._zod.bag,i=(t.inclusive?r.minimum:r.exclusiveMinimum)??Number.NEGATIVE_INFINITY;t.value>i&&(t.inclusive?r.minimum=t.value:r.exclusiveMinimum=t.value)}),e._zod.check=o=>{(t.inclusive?o.value>=t.value:o.value>t.value)||o.issues.push({origin:n,code:"too_small",minimum:t.value,input:o.value,inclusive:t.inclusive,inst:e,continue:!t.abort})}}),Dn=s("$ZodCheckMultipleOf",(e,t)=>{x.init(e,t),e._zod.onattach.push(n=>{var o;(o=n._zod.bag).multipleOf??(o.multipleOf=t.value)}),e._zod.check=n=>{if(typeof n.value!=typeof t.value)throw new Error("Cannot mix number and bigint in multiple_of check.");(typeof n.value=="bigint"?n.value%t.value===BigInt(0):qt(n.value,t.value)===0)||n.issues.push({origin:typeof n.value,code:"not_multiple_of",divisor:t.value,input:n.value,inst:e,continue:!t.abort})}}),Pn=s("$ZodCheckNumberFormat",(e,t)=>{x.init(e,t),t.format=t.format||"float64";const n=t.format?.includes("int"),o=n?"int":"number",[r,i]=Qt[t.format];e._zod.onattach.push(a=>{const c=a._zod.bag;c.format=t.format,c.minimum=r,c.maximum=i,n&&(c.pattern=An)}),e._zod.check=a=>{const c=a.value;if(n){if(!Number.isInteger(c)){a.issues.push({expected:o,format:t.format,code:"invalid_type",input:c,inst:e});return}if(!Number.isSafeInteger(c)){c>0?a.issues.push({input:c,code:"too_big",maximum:Number.MAX_SAFE_INTEGER,note:"Integers must be within the safe integer range.",inst:e,origin:o,continue:!t.abort}):a.issues.push({input:c,code:"too_small",minimum:Number.MIN_SAFE_INTEGER,note:"Integers must be within the safe integer range.",inst:e,origin:o,continue:!t.abort});return}}c<r&&a.issues.push({origin:"number",input:c,code:"too_small",minimum:r,inclusive:!0,inst:e,continue:!t.abort}),c>i&&a.issues.push({origin:"number",input:c,code:"too_big",maximum:i,inst:e})}}),Nn=s("$ZodCheckMaxLength",(e,t)=>{var n;x.init(e,t),(n=e._zod.def).when??(n.when=o=>{const r=o.value;return!ve(r)&&r.length!==void 0}),e._zod.onattach.push(o=>{const r=o._zod.bag.maximum??Number.POSITIVE_INFINITY;t.maximum<r&&(o._zod.bag.maximum=t.maximum)}),e._zod.check=o=>{const r=o.value;if(r.length<=t.maximum)return;const a=ke(r);o.issues.push({origin:a,code:"too_big",maximum:t.maximum,inclusive:!0,input:r,inst:e,continue:!t.abort})}}),Un=s("$ZodCheckMinLength",(e,t)=>{var n;x.init(e,t),(n=e._zod.def).when??(n.when=o=>{const r=o.value;return!ve(r)&&r.length!==void 0}),e._zod.onattach.push(o=>{const r=o._zod.bag.minimum??Number.NEGATIVE_INFINITY;t.minimum>r&&(o._zod.bag.minimum=t.minimum)}),e._zod.check=o=>{const r=o.value;if(r.length>=t.minimum)return;const a=ke(r);o.issues.push({origin:a,code:"too_small",minimum:t.minimum,inclusive:!0,input:r,inst:e,continue:!t.abort})}}),Fn=s("$ZodCheckLengthEquals",(e,t)=>{var n;x.init(e,t),(n=e._zod.def).when??(n.when=o=>{const r=o.value;return!ve(r)&&r.length!==void 0}),e._zod.onattach.push(o=>{const r=o._zod.bag;r.minimum=t.length,r.maximum=t.length,r.length=t.length}),e._zod.check=o=>{const r=o.value,i=r.length;if(i===t.length)return;const a=ke(r),c=i>t.length;o.issues.push({origin:a,...c?{code:"too_big",maximum:t.length}:{code:"too_small",minimum:t.length},inclusive:!0,exact:!0,input:o.value,inst:e,continue:!t.abort})}}),ie=s("$ZodCheckStringFormat",(e,t)=>{var n,o;x.init(e,t),e._zod.onattach.push(r=>{const i=r._zod.bag;i.format=t.format,t.pattern&&(i.patterns??(i.patterns=new Set),i.patterns.add(t.pattern))}),t.pattern?(n=e._zod).check??(n.check=r=>{t.pattern.lastIndex=0,!t.pattern.test(r.value)&&r.issues.push({origin:"string",code:"invalid_format",format:t.format,input:r.value,...t.pattern?{pattern:t.pattern.toString()}:{},inst:e,continue:!t.abort})}):(o=e._zod).check??(o.check=()=>{})}),Ln=s("$ZodCheckRegex",(e,t)=>{ie.init(e,t),e._zod.check=n=>{t.pattern.lastIndex=0,!t.pattern.test(n.value)&&n.issues.push({origin:"string",code:"invalid_format",format:"regex",input:n.value,pattern:t.pattern.toString(),inst:e,continue:!t.abort})}}),Wn=s("$ZodCheckLowerCase",(e,t)=>{t.pattern??(t.pattern=xn),ie.init(e,t)}),Mn=s("$ZodCheckUpperCase",(e,t)=>{t.pattern??(t.pattern=On),ie.init(e,t)}),jn=s("$ZodCheckIncludes",(e,t)=>{x.init(e,t);const n=re(t.includes),o=new RegExp(typeof t.position=="number"?`^.{${t.position}}${n}`:n);t.pattern=o,e._zod.onattach.push(r=>{const i=r._zod.bag;i.patterns??(i.patterns=new Set),i.patterns.add(o)}),e._zod.check=r=>{r.value.includes(t.includes,t.position)||r.issues.push({origin:"string",code:"invalid_format",format:"includes",includes:t.includes,input:r.value,inst:e,continue:!t.abort})}}),Bn=s("$ZodCheckStartsWith",(e,t)=>{x.init(e,t);const n=new RegExp(`^${re(t.prefix)}.*`);t.pattern??(t.pattern=n),e._zod.onattach.push(o=>{const r=o._zod.bag;r.patterns??(r.patterns=new Set),r.patterns.add(n)}),e._zod.check=o=>{o.value.startsWith(t.prefix)||o.issues.push({origin:"string",code:"invalid_format",format:"starts_with",prefix:t.prefix,input:o.value,inst:e,continue:!t.abort})}}),qn=s("$ZodCheckEndsWith",(e,t)=>{x.init(e,t);const n=new RegExp(`.*${re(t.suffix)}$`);t.pattern??(t.pattern=n),e._zod.onattach.push(o=>{const r=o._zod.bag;r.patterns??(r.patterns=new Set),r.patterns.add(n)}),e._zod.check=o=>{o.value.endsWith(t.suffix)||o.issues.push({origin:"string",code:"invalid_format",format:"ends_with",suffix:t.suffix,input:o.value,inst:e,continue:!t.abort})}}),Vn=s("$ZodCheckOverwrite",(e,t)=>{x.init(e,t),e._zod.check=n=>{n.value=t.tx(n.value)}});class Yn{constructor(t=[]){this.content=[],this.indent=0,this&&(this.args=t)}indented(t){this.indent+=1,t(this),this.indent-=1}write(t){if(typeof t=="function"){t(this,{execution:"sync"}),t(this,{execution:"async"});return}const o=t.split(`
`).filter(a=>a),r=Math.min(...o.map(a=>a.length-a.trimStart().length)),i=o.map(a=>a.slice(r)).map(a=>" ".repeat(this.indent*2)+a);for(const a of i)this.content.push(a)}compile(){const t=Function,n=this?.args,r=[...(this?.content??[""]).map(i=>`  ${i}`)];return new t(...n,r.join(`
`))}}const Gn={major:4,minor:0,patch:5},Z=s("$ZodType",(e,t)=>{var n;e??(e={}),e._zod.def=t,e._zod.bag=e._zod.bag||{},e._zod.version=Gn;const o=[...e._zod.def.checks??[]];e._zod.traits.has("$ZodCheck")&&o.unshift(e);for(const r of o)for(const i of r._zod.onattach)i(e);if(o.length===0)(n=e._zod).deferred??(n.deferred=[]),e._zod.deferred?.push(()=>{e._zod.run=e._zod.parse});else{const r=(i,a,c)=>{let d=G(i),f;for(const v of a){if(v._zod.def.when){if(!v._zod.def.when(i))continue}else if(d)continue;const h=i.issues.length,p=v._zod.check(i);if(p instanceof Promise&&c?.async===!1)throw new X;if(f||p instanceof Promise)f=(f??Promise.resolve()).then(async()=>{await p,i.issues.length!==h&&(d||(d=G(i,h)))});else{if(i.issues.length===h)continue;d||(d=G(i,h))}}return f?f.then(()=>i):i};e._zod.run=(i,a)=>{const c=e._zod.parse(i,a);if(c instanceof Promise){if(a.async===!1)throw new X;return c.then(d=>r(d,o,a))}return r(c,o,a)}}e["~standard"]={validate:r=>{try{const i=sn(e,r);return i.success?{value:i.data}:{issues:i.error?.issues}}catch{return cn(e,r).then(a=>a.success?{value:a.data}:{issues:a.error?.issues})}},vendor:"zod",version:1}}),Se=s("$ZodString",(e,t)=>{Z.init(e,t),e._zod.pattern=[...e?._zod.bag?.patterns??[]].pop()??Tn(e._zod.bag),e._zod.parse=(n,o)=>{if(t.coerce)try{n.value=String(n.value)}catch{}return typeof n.value=="string"||n.issues.push({expected:"string",code:"invalid_type",input:n.value,inst:e}),n}}),I=s("$ZodStringFormat",(e,t)=>{ie.init(e,t),Se.init(e,t)}),Qn=s("$ZodGUID",(e,t)=>{t.pattern??(t.pattern=gn),I.init(e,t)}),Xn=s("$ZodUUID",(e,t)=>{if(t.version){const o={v1:1,v2:2,v3:3,v4:4,v5:5,v6:6,v7:7,v8:8}[t.version];if(o===void 0)throw new Error(`Invalid UUID version: "${t.version}"`);t.pattern??(t.pattern=xe(o))}else t.pattern??(t.pattern=xe());I.init(e,t)}),Kn=s("$ZodEmail",(e,t)=>{t.pattern??(t.pattern=_n),I.init(e,t)}),Jn=s("$ZodURL",(e,t)=>{I.init(e,t),e._zod.check=n=>{try{const o=n.value,r=new URL(o),i=r.href;t.hostname&&(t.hostname.lastIndex=0,t.hostname.test(r.hostname)||n.issues.push({code:"invalid_format",format:"url",note:"Invalid hostname",pattern:En.source,input:n.value,inst:e,continue:!t.abort})),t.protocol&&(t.protocol.lastIndex=0,t.protocol.test(r.protocol.endsWith(":")?r.protocol.slice(0,-1):r.protocol)||n.issues.push({code:"invalid_format",format:"url",note:"Invalid protocol",pattern:t.protocol.source,input:n.value,inst:e,continue:!t.abort})),!o.endsWith("/")&&i.endsWith("/")?n.value=i.slice(0,-1):n.value=i;return}catch{n.issues.push({code:"invalid_format",format:"url",input:n.value,inst:e,continue:!t.abort})}}}),Hn=s("$ZodEmoji",(e,t)=>{t.pattern??(t.pattern=wn()),I.init(e,t)}),eo=s("$ZodNanoID",(e,t)=>{t.pattern??(t.pattern=fn),I.init(e,t)}),to=s("$ZodCUID",(e,t)=>{t.pattern??(t.pattern=un),I.init(e,t)}),no=s("$ZodCUID2",(e,t)=>{t.pattern??(t.pattern=ln),I.init(e,t)}),oo=s("$ZodULID",(e,t)=>{t.pattern??(t.pattern=dn),I.init(e,t)}),ro=s("$ZodXID",(e,t)=>{t.pattern??(t.pattern=pn),I.init(e,t)}),io=s("$ZodKSUID",(e,t)=>{t.pattern??(t.pattern=hn),I.init(e,t)}),ao=s("$ZodISODateTime",(e,t)=>{t.pattern??(t.pattern=Cn(t)),I.init(e,t)}),so=s("$ZodISODate",(e,t)=>{t.pattern??(t.pattern=Zn),I.init(e,t)}),co=s("$ZodISOTime",(e,t)=>{t.pattern??(t.pattern=$n(t)),I.init(e,t)}),uo=s("$ZodISODuration",(e,t)=>{t.pattern??(t.pattern=mn),I.init(e,t)}),lo=s("$ZodIPv4",(e,t)=>{t.pattern??(t.pattern=bn),I.init(e,t),e._zod.onattach.push(n=>{const o=n._zod.bag;o.format="ipv4"})}),po=s("$ZodIPv6",(e,t)=>{t.pattern??(t.pattern=yn),I.init(e,t),e._zod.onattach.push(n=>{const o=n._zod.bag;o.format="ipv6"}),e._zod.check=n=>{try{new URL(`http://[${n.value}]`)}catch{n.issues.push({code:"invalid_format",format:"ipv6",input:n.value,inst:e,continue:!t.abort})}}}),ho=s("$ZodCIDRv4",(e,t)=>{t.pattern??(t.pattern=kn),I.init(e,t)}),fo=s("$ZodCIDRv6",(e,t)=>{t.pattern??(t.pattern=Sn),I.init(e,t),e._zod.check=n=>{const[o,r]=n.value.split("/");try{if(!r)throw new Error;const i=Number(r);if(`${i}`!==r)throw new Error;if(i<0||i>128)throw new Error;new URL(`http://[${o}]`)}catch{n.issues.push({code:"invalid_format",format:"cidrv6",input:n.value,inst:e,continue:!t.abort})}}});function _t(e){if(e==="")return!0;if(e.length%4!==0)return!1;try{return atob(e),!0}catch{return!1}}const mo=s("$ZodBase64",(e,t)=>{t.pattern??(t.pattern=In),I.init(e,t),e._zod.onattach.push(n=>{n._zod.bag.contentEncoding="base64"}),e._zod.check=n=>{_t(n.value)||n.issues.push({code:"invalid_format",format:"base64",input:n.value,inst:e,continue:!t.abort})}});function go(e){if(!dt.test(e))return!1;const t=e.replace(/[-_]/g,o=>o==="-"?"+":"/"),n=t.padEnd(Math.ceil(t.length/4)*4,"=");return _t(n)}const _o=s("$ZodBase64URL",(e,t)=>{t.pattern??(t.pattern=dt),I.init(e,t),e._zod.onattach.push(n=>{n._zod.bag.contentEncoding="base64url"}),e._zod.check=n=>{go(n.value)||n.issues.push({code:"invalid_format",format:"base64url",input:n.value,inst:e,continue:!t.abort})}}),vo=s("$ZodE164",(e,t)=>{t.pattern??(t.pattern=zn),I.init(e,t)});function wo(e,t=null){try{const n=e.split(".");if(n.length!==3)return!1;const[o]=n;if(!o)return!1;const r=JSON.parse(atob(o));return!("typ"in r&&r?.typ!=="JWT"||!r.alg||t&&(!("alg"in r)||r.alg!==t))}catch{return!1}}const bo=s("$ZodJWT",(e,t)=>{I.init(e,t),e._zod.check=n=>{wo(n.value,t.alg)||n.issues.push({code:"invalid_format",format:"jwt",input:n.value,inst:e,continue:!t.abort})}}),vt=s("$ZodNumber",(e,t)=>{Z.init(e,t),e._zod.pattern=e._zod.bag.pattern??Rn,e._zod.parse=(n,o)=>{if(t.coerce)try{n.value=Number(n.value)}catch{}const r=n.value;if(typeof r=="number"&&!Number.isNaN(r)&&Number.isFinite(r))return n;const i=typeof r=="number"?Number.isNaN(r)?"NaN":Number.isFinite(r)?void 0:"Infinity":void 0;return n.issues.push({expected:"number",code:"invalid_type",input:r,inst:e,...i?{received:i}:{}}),n}}),yo=s("$ZodNumber",(e,t)=>{Pn.init(e,t),vt.init(e,t)}),ko=s("$ZodAny",(e,t)=>{Z.init(e,t),e._zod.parse=n=>n}),So=s("$ZodUnknown",(e,t)=>{Z.init(e,t),e._zod.parse=n=>n}),Io=s("$ZodNever",(e,t)=>{Z.init(e,t),e._zod.parse=(n,o)=>(n.issues.push({expected:"never",code:"invalid_type",input:n.value,inst:e}),n)});function Oe(e,t,n){e.issues.length&&t.issues.push(...ye(n,e.issues)),t.value[n]=e.value}const Eo=s("$ZodArray",(e,t)=>{Z.init(e,t),e._zod.parse=(n,o)=>{const r=n.value;if(!Array.isArray(r))return n.issues.push({expected:"array",code:"invalid_type",input:r,inst:e}),n;n.value=Array(r.length);const i=[];for(let a=0;a<r.length;a++){const c=r[a],d=t.element._zod.run({value:c,issues:[]},o);d instanceof Promise?i.push(d.then(f=>Oe(f,n,a))):Oe(d,n,a)}return i.length?Promise.all(i).then(()=>n):n}});function ee(e,t,n){e.issues.length&&t.issues.push(...ye(n,e.issues)),t.value[n]=e.value}function De(e,t,n,o){e.issues.length?o[n]===void 0?n in o?t.value[n]=void 0:t.value[n]=e.value:t.issues.push(...ye(n,e.issues)):e.value===void 0?n in o&&(t.value[n]=void 0):t.value[n]=e.value}const zo=s("$ZodObject",(e,t)=>{Z.init(e,t);const n=rt(()=>{const h=Object.keys(t.shape);for(const _ of h)if(!(t.shape[_]instanceof Z))throw new Error(`Invalid element at key "${_}": expected a Zod schema`);const p=Gt(t.shape);return{shape:t.shape,keys:h,keySet:new Set(h),numKeys:h.length,optionalKeys:new Set(p)}});S(e._zod,"propValues",()=>{const h=t.shape,p={};for(const _ in h){const b=h[_]._zod;if(b.values){p[_]??(p[_]=new Set);for(const $ of b.values)p[_].add($)}}return p});const o=h=>{const p=new Yn(["shape","payload","ctx"]),_=n.value,b=C=>{const k=Y(C);return`shape[${k}]._zod.run({ value: input[${k}], issues: [] }, ctx)`};p.write("const input = payload.value;");const $=Object.create(null);let A=0;for(const C of _.keys)$[C]=`key_${A++}`;p.write("const newResult = {}");for(const C of _.keys)if(_.optionalKeys.has(C)){const k=$[C];p.write(`const ${k} = ${b(C)};`);const z=Y(C);p.write(`
        if (${k}.issues.length) {
          if (input[${z}] === undefined) {
            if (${z} in input) {
              newResult[${z}] = undefined;
            }
          } else {
            payload.issues = payload.issues.concat(
              ${k}.issues.map((iss) => ({
                ...iss,
                path: iss.path ? [${z}, ...iss.path] : [${z}],
              }))
            );
          }
        } else if (${k}.value === undefined) {
          if (${z} in input) newResult[${z}] = undefined;
        } else {
          newResult[${z}] = ${k}.value;
        }
        `)}else{const k=$[C];p.write(`const ${k} = ${b(C)};`),p.write(`
          if (${k}.issues.length) payload.issues = payload.issues.concat(${k}.issues.map(iss => ({
            ...iss,
            path: iss.path ? [${Y(C)}, ...iss.path] : [${Y(C)}]
          })));`),p.write(`newResult[${Y(C)}] = ${k}.value`)}p.write("payload.value = newResult;"),p.write("return payload;");const D=p.compile();return(C,k)=>D(h,C,k)};let r;const i=de,a=!ot.jitless,d=a&&Vt.value,f=t.catchall;let v;e._zod.parse=(h,p)=>{v??(v=n.value);const _=h.value;if(!i(_))return h.issues.push({expected:"object",code:"invalid_type",input:_,inst:e}),h;const b=[];if(a&&d&&p?.async===!1&&p.jitless!==!0)r||(r=o(t.shape)),h=r(h,p);else{h.value={};const k=v.shape;for(const z of v.keys){const N=k[z],F=N._zod.run({value:_[z],issues:[]},p),B=N._zod.optin==="optional"&&N._zod.optout==="optional";F instanceof Promise?b.push(F.then(j=>B?De(j,h,z,_):ee(j,h,z))):B?De(F,h,z,_):ee(F,h,z)}}if(!f)return b.length?Promise.all(b).then(()=>h):h;const $=[],A=v.keySet,D=f._zod,C=D.def.type;for(const k of Object.keys(_)){if(A.has(k))continue;if(C==="never"){$.push(k);continue}const z=D.run({value:_[k],issues:[]},p);z instanceof Promise?b.push(z.then(N=>ee(N,h,k))):ee(z,h,k)}return $.length&&h.issues.push({code:"unrecognized_keys",keys:$,input:_,inst:e}),b.length?Promise.all(b).then(()=>h):h}});function Pe(e,t,n,o){for(const r of e)if(r.issues.length===0)return t.value=r.value,t;return t.issues.push({code:"invalid_union",input:t.value,inst:n,errors:e.map(r=>r.issues.map(i=>W(i,o,L())))}),t}const Zo=s("$ZodUnion",(e,t)=>{Z.init(e,t),S(e._zod,"optin",()=>t.options.some(n=>n._zod.optin==="optional")?"optional":void 0),S(e._zod,"optout",()=>t.options.some(n=>n._zod.optout==="optional")?"optional":void 0),S(e._zod,"values",()=>{if(t.options.every(n=>n._zod.values))return new Set(t.options.flatMap(n=>Array.from(n._zod.values)))}),S(e._zod,"pattern",()=>{if(t.options.every(n=>n._zod.pattern)){const n=t.options.map(o=>o._zod.pattern);return new RegExp(`^(${n.map(o=>we(o.source)).join("|")})$`)}}),e._zod.parse=(n,o)=>{let r=!1;const i=[];for(const a of t.options){const c=a._zod.run({value:n.value,issues:[]},o);if(c instanceof Promise)i.push(c),r=!0;else{if(c.issues.length===0)return c;i.push(c)}}return r?Promise.all(i).then(a=>Pe(a,n,e,o)):Pe(i,n,e,o)}}),$o=s("$ZodIntersection",(e,t)=>{Z.init(e,t),e._zod.parse=(n,o)=>{const r=n.value,i=t.left._zod.run({value:r,issues:[]},o),a=t.right._zod.run({value:r,issues:[]},o);return i instanceof Promise||a instanceof Promise?Promise.all([i,a]).then(([d,f])=>Ne(n,d,f)):Ne(n,i,a)}});function he(e,t){if(e===t)return{valid:!0,data:e};if(e instanceof Date&&t instanceof Date&&+e==+t)return{valid:!0,data:e};if(pe(e)&&pe(t)){const n=Object.keys(t),o=Object.keys(e).filter(i=>n.indexOf(i)!==-1),r={...e,...t};for(const i of o){const a=he(e[i],t[i]);if(!a.valid)return{valid:!1,mergeErrorPath:[i,...a.mergeErrorPath]};r[i]=a.data}return{valid:!0,data:r}}if(Array.isArray(e)&&Array.isArray(t)){if(e.length!==t.length)return{valid:!1,mergeErrorPath:[]};const n=[];for(let o=0;o<e.length;o++){const r=e[o],i=t[o],a=he(r,i);if(!a.valid)return{valid:!1,mergeErrorPath:[o,...a.mergeErrorPath]};n.push(a.data)}return{valid:!0,data:n}}return{valid:!1,mergeErrorPath:[]}}function Ne(e,t,n){if(t.issues.length&&e.issues.push(...t.issues),n.issues.length&&e.issues.push(...n.issues),G(e))return e;const o=he(t.value,n.value);if(!o.valid)throw new Error(`Unmergable intersection. Error path: ${JSON.stringify(o.mergeErrorPath)}`);return e.value=o.data,e}const Co=s("$ZodEnum",(e,t)=>{Z.init(e,t);const n=jt(t.entries);e._zod.values=new Set(n),e._zod.pattern=new RegExp(`^(${n.filter(o=>Yt.has(typeof o)).map(o=>typeof o=="string"?re(o):o.toString()).join("|")})$`),e._zod.parse=(o,r)=>{const i=o.value;return e._zod.values.has(i)||o.issues.push({code:"invalid_value",values:n,input:i,inst:e}),o}}),To=s("$ZodTransform",(e,t)=>{Z.init(e,t),e._zod.parse=(n,o)=>{const r=t.transform(n.value,n);if(o.async)return(r instanceof Promise?r:Promise.resolve(r)).then(a=>(n.value=a,n));if(r instanceof Promise)throw new X;return n.value=r,n}}),Ao=s("$ZodOptional",(e,t)=>{Z.init(e,t),e._zod.optin="optional",e._zod.optout="optional",S(e._zod,"values",()=>t.innerType._zod.values?new Set([...t.innerType._zod.values,void 0]):void 0),S(e._zod,"pattern",()=>{const n=t.innerType._zod.pattern;return n?new RegExp(`^(${we(n.source)})?$`):void 0}),e._zod.parse=(n,o)=>t.innerType._zod.optin==="optional"?t.innerType._zod.run(n,o):n.value===void 0?n:t.innerType._zod.run(n,o)}),Ro=s("$ZodNullable",(e,t)=>{Z.init(e,t),S(e._zod,"optin",()=>t.innerType._zod.optin),S(e._zod,"optout",()=>t.innerType._zod.optout),S(e._zod,"pattern",()=>{const n=t.innerType._zod.pattern;return n?new RegExp(`^(${we(n.source)}|null)$`):void 0}),S(e._zod,"values",()=>t.innerType._zod.values?new Set([...t.innerType._zod.values,null]):void 0),e._zod.parse=(n,o)=>n.value===null?n:t.innerType._zod.run(n,o)}),xo=s("$ZodDefault",(e,t)=>{Z.init(e,t),e._zod.optin="optional",S(e._zod,"values",()=>t.innerType._zod.values),e._zod.parse=(n,o)=>{if(n.value===void 0)return n.value=t.defaultValue,n;const r=t.innerType._zod.run(n,o);return r instanceof Promise?r.then(i=>Ue(i,t)):Ue(r,t)}});function Ue(e,t){return e.value===void 0&&(e.value=t.defaultValue),e}const Oo=s("$ZodPrefault",(e,t)=>{Z.init(e,t),e._zod.optin="optional",S(e._zod,"values",()=>t.innerType._zod.values),e._zod.parse=(n,o)=>(n.value===void 0&&(n.value=t.defaultValue),t.innerType._zod.run(n,o))}),Do=s("$ZodNonOptional",(e,t)=>{Z.init(e,t),S(e._zod,"values",()=>{const n=t.innerType._zod.values;return n?new Set([...n].filter(o=>o!==void 0)):void 0}),e._zod.parse=(n,o)=>{const r=t.innerType._zod.run(n,o);return r instanceof Promise?r.then(i=>Fe(i,e)):Fe(r,e)}});function Fe(e,t){return!e.issues.length&&e.value===void 0&&e.issues.push({code:"invalid_type",expected:"nonoptional",input:e.value,inst:t}),e}const Po=s("$ZodCatch",(e,t)=>{Z.init(e,t),e._zod.optin="optional",S(e._zod,"optout",()=>t.innerType._zod.optout),S(e._zod,"values",()=>t.innerType._zod.values),e._zod.parse=(n,o)=>{const r=t.innerType._zod.run(n,o);return r instanceof Promise?r.then(i=>(n.value=i.value,i.issues.length&&(n.value=t.catchValue({...n,error:{issues:i.issues.map(a=>W(a,o,L()))},input:n.value}),n.issues=[]),n)):(n.value=r.value,r.issues.length&&(n.value=t.catchValue({...n,error:{issues:r.issues.map(i=>W(i,o,L()))},input:n.value}),n.issues=[]),n)}}),No=s("$ZodPipe",(e,t)=>{Z.init(e,t),S(e._zod,"values",()=>t.in._zod.values),S(e._zod,"optin",()=>t.in._zod.optin),S(e._zod,"optout",()=>t.out._zod.optout),S(e._zod,"propValues",()=>t.in._zod.propValues),e._zod.parse=(n,o)=>{const r=t.in._zod.run(n,o);return r instanceof Promise?r.then(i=>Le(i,t,o)):Le(r,t,o)}});function Le(e,t,n){return G(e)?e:t.out._zod.run({value:e.value,issues:e.issues},n)}const Uo=s("$ZodReadonly",(e,t)=>{Z.init(e,t),S(e._zod,"propValues",()=>t.innerType._zod.propValues),S(e._zod,"values",()=>t.innerType._zod.values),S(e._zod,"optin",()=>t.innerType._zod.optin),S(e._zod,"optout",()=>t.innerType._zod.optout),e._zod.parse=(n,o)=>{const r=t.innerType._zod.run(n,o);return r instanceof Promise?r.then(We):We(r)}});function We(e){return e.value=Object.freeze(e.value),e}const Fo=s("$ZodCustom",(e,t)=>{x.init(e,t),Z.init(e,t),e._zod.parse=(n,o)=>n,e._zod.check=n=>{const o=n.value,r=t.fn(o);if(r instanceof Promise)return r.then(i=>Me(i,n,o,e));Me(r,n,o,e)}});function Me(e,t,n,o){if(!e){const r={code:"custom",input:n,inst:o,path:[...o._zod.def.path??[]],continue:!o._zod.def.abort};o._zod.def.params&&(r.params=o._zod.def.params),t.issues.push(K(r))}}class Lo{constructor(){this._map=new Map,this._idmap=new Map}add(t,...n){const o=n[0];if(this._map.set(t,o),o&&typeof o=="object"&&"id"in o){if(this._idmap.has(o.id))throw new Error(`ID ${o.id} already exists in the registry`);this._idmap.set(o.id,t)}return this}clear(){return this._map=new Map,this._idmap=new Map,this}remove(t){const n=this._map.get(t);return n&&typeof n=="object"&&"id"in n&&this._idmap.delete(n.id),this._map.delete(t),this}get(t){const n=t._zod.parent;if(n){const o={...this.get(n)??{}};return delete o.id,{...o,...this._map.get(t)}}return this._map.get(t)}has(t){return this._map.has(t)}}function Wo(){return new Lo}const te=Wo();function Mo(e,t){return new e({type:"string",...m(t)})}function jo(e,t){return new e({type:"string",format:"email",check:"string_format",abort:!1,...m(t)})}function je(e,t){return new e({type:"string",format:"guid",check:"string_format",abort:!1,...m(t)})}function Bo(e,t){return new e({type:"string",format:"uuid",check:"string_format",abort:!1,...m(t)})}function qo(e,t){return new e({type:"string",format:"uuid",check:"string_format",abort:!1,version:"v4",...m(t)})}function Vo(e,t){return new e({type:"string",format:"uuid",check:"string_format",abort:!1,version:"v6",...m(t)})}function Yo(e,t){return new e({type:"string",format:"uuid",check:"string_format",abort:!1,version:"v7",...m(t)})}function Go(e,t){return new e({type:"string",format:"url",check:"string_format",abort:!1,...m(t)})}function Qo(e,t){return new e({type:"string",format:"emoji",check:"string_format",abort:!1,...m(t)})}function Xo(e,t){return new e({type:"string",format:"nanoid",check:"string_format",abort:!1,...m(t)})}function Ko(e,t){return new e({type:"string",format:"cuid",check:"string_format",abort:!1,...m(t)})}function Jo(e,t){return new e({type:"string",format:"cuid2",check:"string_format",abort:!1,...m(t)})}function Ho(e,t){return new e({type:"string",format:"ulid",check:"string_format",abort:!1,...m(t)})}function er(e,t){return new e({type:"string",format:"xid",check:"string_format",abort:!1,...m(t)})}function tr(e,t){return new e({type:"string",format:"ksuid",check:"string_format",abort:!1,...m(t)})}function nr(e,t){return new e({type:"string",format:"ipv4",check:"string_format",abort:!1,...m(t)})}function or(e,t){return new e({type:"string",format:"ipv6",check:"string_format",abort:!1,...m(t)})}function rr(e,t){return new e({type:"string",format:"cidrv4",check:"string_format",abort:!1,...m(t)})}function ir(e,t){return new e({type:"string",format:"cidrv6",check:"string_format",abort:!1,...m(t)})}function ar(e,t){return new e({type:"string",format:"base64",check:"string_format",abort:!1,...m(t)})}function sr(e,t){return new e({type:"string",format:"base64url",check:"string_format",abort:!1,...m(t)})}function cr(e,t){return new e({type:"string",format:"e164",check:"string_format",abort:!1,...m(t)})}function ur(e,t){return new e({type:"string",format:"jwt",check:"string_format",abort:!1,...m(t)})}function lr(e,t){return new e({type:"string",format:"datetime",check:"string_format",offset:!1,local:!1,precision:null,...m(t)})}function dr(e,t){return new e({type:"string",format:"date",check:"string_format",...m(t)})}function pr(e,t){return new e({type:"string",format:"time",check:"string_format",precision:null,...m(t)})}function hr(e,t){return new e({type:"string",format:"duration",check:"string_format",...m(t)})}function fr(e,t){return new e({type:"number",checks:[],...m(t)})}function mr(e,t){return new e({type:"number",check:"number_format",abort:!1,format:"safeint",...m(t)})}function gr(e){return new e({type:"any"})}function _r(e){return new e({type:"unknown"})}function vr(e,t){return new e({type:"never",...m(t)})}function Be(e,t){return new mt({check:"less_than",...m(t),value:e,inclusive:!1})}function ue(e,t){return new mt({check:"less_than",...m(t),value:e,inclusive:!0})}function qe(e,t){return new gt({check:"greater_than",...m(t),value:e,inclusive:!1})}function le(e,t){return new gt({check:"greater_than",...m(t),value:e,inclusive:!0})}function Ve(e,t){return new Dn({check:"multiple_of",...m(t),value:e})}function wt(e,t){return new Nn({check:"max_length",...m(t),maximum:e})}function oe(e,t){return new Un({check:"min_length",...m(t),minimum:e})}function bt(e,t){return new Fn({check:"length_equals",...m(t),length:e})}function wr(e,t){return new Ln({check:"string_format",format:"regex",...m(t),pattern:e})}function br(e){return new Wn({check:"string_format",format:"lowercase",...m(e)})}function yr(e){return new Mn({check:"string_format",format:"uppercase",...m(e)})}function kr(e,t){return new jn({check:"string_format",format:"includes",...m(t),includes:e})}function Sr(e,t){return new Bn({check:"string_format",format:"starts_with",...m(t),prefix:e})}function Ir(e,t){return new qn({check:"string_format",format:"ends_with",...m(t),suffix:e})}function J(e){return new Vn({check:"overwrite",tx:e})}function Er(e){return J(t=>t.normalize(e))}function zr(){return J(e=>e.trim())}function Zr(){return J(e=>e.toLowerCase())}function $r(){return J(e=>e.toUpperCase())}function Cr(e,t,n){return new e({type:"array",element:t,...m(n)})}function Tr(e,t,n){return new e({type:"custom",check:"custom",fn:t,...m(n)})}const Ar=s("ZodISODateTime",(e,t)=>{ao.init(e,t),E.init(e,t)});function Rr(e){return lr(Ar,e)}const xr=s("ZodISODate",(e,t)=>{so.init(e,t),E.init(e,t)});function Or(e){return dr(xr,e)}const Dr=s("ZodISOTime",(e,t)=>{co.init(e,t),E.init(e,t)});function Pr(e){return pr(Dr,e)}const Nr=s("ZodISODuration",(e,t)=>{uo.init(e,t),E.init(e,t)});function Ur(e){return hr(Nr,e)}const Fr=(e,t)=>{st.init(e,t),e.name="ZodError",Object.defineProperties(e,{format:{value:n=>on(e,n)},flatten:{value:n=>nn(e,n)},addIssue:{value:n=>e.issues.push(n)},addIssues:{value:n=>e.issues.push(...n)},isEmpty:{get(){return e.issues.length===0}}})},ae=s("ZodError",Fr,{Parent:Error}),Lr=rn(ae),Wr=an(ae),Mr=ut(ae),jr=lt(ae),T=s("ZodType",(e,t)=>(Z.init(e,t),e.def=t,Object.defineProperty(e,"_def",{value:t}),e.check=(...n)=>e.clone({...t,checks:[...t.checks??[],...n.map(o=>typeof o=="function"?{_zod:{check:o,def:{check:"custom"},onattach:[]}}:o)]}),e.clone=(n,o)=>M(e,n,o),e.brand=()=>e,e.register=(n,o)=>(n.add(e,o),e),e.parse=(n,o)=>Lr(e,n,o,{callee:e.parse}),e.safeParse=(n,o)=>Mr(e,n,o),e.parseAsync=async(n,o)=>Wr(e,n,o,{callee:e.parseAsync}),e.safeParseAsync=async(n,o)=>jr(e,n,o),e.spa=e.safeParseAsync,e.refine=(n,o)=>e.check(Pi(n,o)),e.superRefine=n=>e.check(Ni(n)),e.overwrite=n=>e.check(J(n)),e.optional=()=>Xe(e),e.nullable=()=>Ke(e),e.nullish=()=>Xe(Ke(e)),e.nonoptional=n=>$i(e,n),e.array=()=>Ie(e),e.or=n=>_i([e,n]),e.and=n=>wi(e,n),e.transform=n=>Je(e,ki(n)),e.default=n=>Ei(e,n),e.prefault=n=>Zi(e,n),e.catch=n=>Ti(e,n),e.pipe=n=>Je(e,n),e.readonly=()=>xi(e),e.describe=n=>{const o=e.clone();return te.add(o,{description:n}),o},Object.defineProperty(e,"description",{get(){return te.get(e)?.description},configurable:!0}),e.meta=(...n)=>{if(n.length===0)return te.get(e);const o=e.clone();return te.add(o,n[0]),o},e.isOptional=()=>e.safeParse(void 0).success,e.isNullable=()=>e.safeParse(null).success,e)),yt=s("_ZodString",(e,t)=>{Se.init(e,t),T.init(e,t);const n=e._zod.bag;e.format=n.format??null,e.minLength=n.minimum??null,e.maxLength=n.maximum??null,e.regex=(...o)=>e.check(wr(...o)),e.includes=(...o)=>e.check(kr(...o)),e.startsWith=(...o)=>e.check(Sr(...o)),e.endsWith=(...o)=>e.check(Ir(...o)),e.min=(...o)=>e.check(oe(...o)),e.max=(...o)=>e.check(wt(...o)),e.length=(...o)=>e.check(bt(...o)),e.nonempty=(...o)=>e.check(oe(1,...o)),e.lowercase=o=>e.check(br(o)),e.uppercase=o=>e.check(yr(o)),e.trim=()=>e.check(zr()),e.normalize=(...o)=>e.check(Er(...o)),e.toLowerCase=()=>e.check(Zr()),e.toUpperCase=()=>e.check($r())}),Br=s("ZodString",(e,t)=>{Se.init(e,t),yt.init(e,t),e.email=n=>e.check(jo(qr,n)),e.url=n=>e.check(Go(Vr,n)),e.jwt=n=>e.check(ur(si,n)),e.emoji=n=>e.check(Qo(Yr,n)),e.guid=n=>e.check(je(Ye,n)),e.uuid=n=>e.check(Bo(ne,n)),e.uuidv4=n=>e.check(qo(ne,n)),e.uuidv6=n=>e.check(Vo(ne,n)),e.uuidv7=n=>e.check(Yo(ne,n)),e.nanoid=n=>e.check(Xo(Gr,n)),e.guid=n=>e.check(je(Ye,n)),e.cuid=n=>e.check(Ko(Qr,n)),e.cuid2=n=>e.check(Jo(Xr,n)),e.ulid=n=>e.check(Ho(Kr,n)),e.base64=n=>e.check(ar(ri,n)),e.base64url=n=>e.check(sr(ii,n)),e.xid=n=>e.check(er(Jr,n)),e.ksuid=n=>e.check(tr(Hr,n)),e.ipv4=n=>e.check(nr(ei,n)),e.ipv6=n=>e.check(or(ti,n)),e.cidrv4=n=>e.check(rr(ni,n)),e.cidrv6=n=>e.check(ir(oi,n)),e.e164=n=>e.check(cr(ai,n)),e.datetime=n=>e.check(Rr(n)),e.date=n=>e.check(Or(n)),e.time=n=>e.check(Pr(n)),e.duration=n=>e.check(Ur(n))});function Q(e){return Mo(Br,e)}const E=s("ZodStringFormat",(e,t)=>{I.init(e,t),yt.init(e,t)}),qr=s("ZodEmail",(e,t)=>{Kn.init(e,t),E.init(e,t)}),Ye=s("ZodGUID",(e,t)=>{Qn.init(e,t),E.init(e,t)}),ne=s("ZodUUID",(e,t)=>{Xn.init(e,t),E.init(e,t)}),Vr=s("ZodURL",(e,t)=>{Jn.init(e,t),E.init(e,t)}),Yr=s("ZodEmoji",(e,t)=>{Hn.init(e,t),E.init(e,t)}),Gr=s("ZodNanoID",(e,t)=>{eo.init(e,t),E.init(e,t)}),Qr=s("ZodCUID",(e,t)=>{to.init(e,t),E.init(e,t)}),Xr=s("ZodCUID2",(e,t)=>{no.init(e,t),E.init(e,t)}),Kr=s("ZodULID",(e,t)=>{oo.init(e,t),E.init(e,t)}),Jr=s("ZodXID",(e,t)=>{ro.init(e,t),E.init(e,t)}),Hr=s("ZodKSUID",(e,t)=>{io.init(e,t),E.init(e,t)}),ei=s("ZodIPv4",(e,t)=>{lo.init(e,t),E.init(e,t)}),ti=s("ZodIPv6",(e,t)=>{po.init(e,t),E.init(e,t)}),ni=s("ZodCIDRv4",(e,t)=>{ho.init(e,t),E.init(e,t)}),oi=s("ZodCIDRv6",(e,t)=>{fo.init(e,t),E.init(e,t)}),ri=s("ZodBase64",(e,t)=>{mo.init(e,t),E.init(e,t)}),ii=s("ZodBase64URL",(e,t)=>{_o.init(e,t),E.init(e,t)}),ai=s("ZodE164",(e,t)=>{vo.init(e,t),E.init(e,t)}),si=s("ZodJWT",(e,t)=>{bo.init(e,t),E.init(e,t)}),kt=s("ZodNumber",(e,t)=>{vt.init(e,t),T.init(e,t),e.gt=(o,r)=>e.check(qe(o,r)),e.gte=(o,r)=>e.check(le(o,r)),e.min=(o,r)=>e.check(le(o,r)),e.lt=(o,r)=>e.check(Be(o,r)),e.lte=(o,r)=>e.check(ue(o,r)),e.max=(o,r)=>e.check(ue(o,r)),e.int=o=>e.check(Ge(o)),e.safe=o=>e.check(Ge(o)),e.positive=o=>e.check(qe(0,o)),e.nonnegative=o=>e.check(le(0,o)),e.negative=o=>e.check(Be(0,o)),e.nonpositive=o=>e.check(ue(0,o)),e.multipleOf=(o,r)=>e.check(Ve(o,r)),e.step=(o,r)=>e.check(Ve(o,r)),e.finite=()=>e;const n=e._zod.bag;e.minValue=Math.max(n.minimum??Number.NEGATIVE_INFINITY,n.exclusiveMinimum??Number.NEGATIVE_INFINITY)??null,e.maxValue=Math.min(n.maximum??Number.POSITIVE_INFINITY,n.exclusiveMaximum??Number.POSITIVE_INFINITY)??null,e.isInt=(n.format??"").includes("int")||Number.isSafeInteger(n.multipleOf??.5),e.isFinite=!0,e.format=n.format??null});function Qi(e){return fr(kt,e)}const ci=s("ZodNumberFormat",(e,t)=>{yo.init(e,t),kt.init(e,t)});function Ge(e){return mr(ci,e)}const ui=s("ZodAny",(e,t)=>{ko.init(e,t),T.init(e,t)});function li(){return gr(ui)}const di=s("ZodUnknown",(e,t)=>{So.init(e,t),T.init(e,t)});function Qe(){return _r(di)}const pi=s("ZodNever",(e,t)=>{Io.init(e,t),T.init(e,t)});function hi(e){return vr(pi,e)}const fi=s("ZodArray",(e,t)=>{Eo.init(e,t),T.init(e,t),e.element=t.element,e.min=(n,o)=>e.check(oe(n,o)),e.nonempty=n=>e.check(oe(1,n)),e.max=(n,o)=>e.check(wt(n,o)),e.length=(n,o)=>e.check(bt(n,o)),e.unwrap=()=>e.element});function Ie(e,t){return Cr(fi,e,t)}const mi=s("ZodObject",(e,t)=>{zo.init(e,t),T.init(e,t),S(e,"shape",()=>t.shape),e.keyof=()=>bi(Object.keys(e._zod.def.shape)),e.catchall=n=>e.clone({...e._zod.def,catchall:n}),e.passthrough=()=>e.clone({...e._zod.def,catchall:Qe()}),e.loose=()=>e.clone({...e._zod.def,catchall:Qe()}),e.strict=()=>e.clone({...e._zod.def,catchall:hi()}),e.strip=()=>e.clone({...e._zod.def,catchall:void 0}),e.extend=n=>Jt(e,n),e.merge=n=>Ht(e,n),e.pick=n=>Xt(e,n),e.omit=n=>Kt(e,n),e.partial=(...n)=>en(St,e,n[0]),e.required=(...n)=>tn(It,e,n[0])});function Ee(e,t){const n={type:"object",get shape(){return be(this,"shape",{...e}),this.shape},...m(t)};return new mi(n)}const gi=s("ZodUnion",(e,t)=>{Zo.init(e,t),T.init(e,t),e.options=t.options});function _i(e,t){return new gi({type:"union",options:e,...m(t)})}const vi=s("ZodIntersection",(e,t)=>{$o.init(e,t),T.init(e,t)});function wi(e,t){return new vi({type:"intersection",left:e,right:t})}const fe=s("ZodEnum",(e,t)=>{Co.init(e,t),T.init(e,t),e.enum=t.entries,e.options=Object.values(t.entries);const n=new Set(Object.keys(t.entries));e.extract=(o,r)=>{const i={};for(const a of o)if(n.has(a))i[a]=t.entries[a];else throw new Error(`Key ${a} not found in enum`);return new fe({...t,checks:[],...m(r),entries:i})},e.exclude=(o,r)=>{const i={...t.entries};for(const a of o)if(n.has(a))delete i[a];else throw new Error(`Key ${a} not found in enum`);return new fe({...t,checks:[],...m(r),entries:i})}});function bi(e,t){const n=Array.isArray(e)?Object.fromEntries(e.map(o=>[o,o])):e;return new fe({type:"enum",entries:n,...m(t)})}const yi=s("ZodTransform",(e,t)=>{To.init(e,t),T.init(e,t),e._zod.parse=(n,o)=>{n.addIssue=i=>{if(typeof i=="string")n.issues.push(K(i,n.value,t));else{const a=i;a.fatal&&(a.continue=!1),a.code??(a.code="custom"),a.input??(a.input=n.value),a.inst??(a.inst=e),a.continue??(a.continue=!0),n.issues.push(K(a))}};const r=t.transform(n.value,n);return r instanceof Promise?r.then(i=>(n.value=i,n)):(n.value=r,n)}});function ki(e){return new yi({type:"transform",transform:e})}const St=s("ZodOptional",(e,t)=>{Ao.init(e,t),T.init(e,t),e.unwrap=()=>e._zod.def.innerType});function Xe(e){return new St({type:"optional",innerType:e})}const Si=s("ZodNullable",(e,t)=>{Ro.init(e,t),T.init(e,t),e.unwrap=()=>e._zod.def.innerType});function Ke(e){return new Si({type:"nullable",innerType:e})}const Ii=s("ZodDefault",(e,t)=>{xo.init(e,t),T.init(e,t),e.unwrap=()=>e._zod.def.innerType,e.removeDefault=e.unwrap});function Ei(e,t){return new Ii({type:"default",innerType:e,get defaultValue(){return typeof t=="function"?t():t}})}const zi=s("ZodPrefault",(e,t)=>{Oo.init(e,t),T.init(e,t),e.unwrap=()=>e._zod.def.innerType});function Zi(e,t){return new zi({type:"prefault",innerType:e,get defaultValue(){return typeof t=="function"?t():t}})}const It=s("ZodNonOptional",(e,t)=>{Do.init(e,t),T.init(e,t),e.unwrap=()=>e._zod.def.innerType});function $i(e,t){return new It({type:"nonoptional",innerType:e,...m(t)})}const Ci=s("ZodCatch",(e,t)=>{Po.init(e,t),T.init(e,t),e.unwrap=()=>e._zod.def.innerType,e.removeCatch=e.unwrap});function Ti(e,t){return new Ci({type:"catch",innerType:e,catchValue:typeof t=="function"?t:()=>t})}const Ai=s("ZodPipe",(e,t)=>{No.init(e,t),T.init(e,t),e.in=t.in,e.out=t.out});function Je(e,t){return new Ai({type:"pipe",in:e,out:t})}const Ri=s("ZodReadonly",(e,t)=>{Uo.init(e,t),T.init(e,t)});function xi(e){return new Ri({type:"readonly",innerType:e})}const Oi=s("ZodCustom",(e,t)=>{Fo.init(e,t),T.init(e,t)});function Di(e){const t=new x({check:"custom"});return t._zod.check=e,t}function Pi(e,t={}){return Tr(Oi,e,t)}function Ni(e){const t=Di(n=>(n.addIssue=o=>{if(typeof o=="string")n.issues.push(K(o,n.value,t._zod.def));else{const r=o;r.fatal&&(r.continue=!1),r.code??(r.code="custom"),r.input??(r.input=n.value),r.inst??(r.inst=t),r.continue??(r.continue=!t._zod.def.abort),n.issues.push(K(r))}},e(n.value,n)));return t}const Et=[{id:"DYN001",title:"The Candle and the Pyre",rarity:"Common",tags:["Choice","Wager","Score"],text:`A moth whispers to you as it flutters by. 'Isn't the fire beautiful?' You have two choices:
- Catch the moth and gain two points now.
- Let it go, and for this round, every 'C' answer will earn you an extra point.`,choices:[{label:"Now",effect:{type:"IMMEDIATE_SCORE",value:2,flavorText:"You snatch the moth from the air. Its dust glitters on your fingers as you feel a surge of insight."}},{label:"Wait",effect:{type:"APPLY_WAGER",target:"answer-c",reward:{type:"SCORE",value:1},flavorText:"You let the moth spiral towards the flame. You feel a strange connection to its fate, tied to your future choices."}},{label:"Ignore"}]},{id:"DYN002",title:"Predictive Loop",rarity:"Uncommon",tags:["Prediction","Gamble","Score"],text:"Nous knows what you will choose. Do you? Predict which answer ('A', 'B', or 'C') you will select most frequently this round. If you are correct, your round score will be doubled.",choices:[{label:"Predict 'A'",effect:{type:"ROUND_PREDICTION",prediction:"A"}},{label:"Predict 'B'",effect:{type:"ROUND_PREDICTION",prediction:"B"}},{label:"Predict 'C'",effect:{type:"ROUND_PREDICTION",prediction:"C"}}],duration:"round",resolveAt:"endOfRound",reward:{type:"DOUBLE_ROUND_SCORE"}},{id:"DYN003",title:"The Forked Path",rarity:"Uncommon",tags:["Risk","Modifier","High-Stakes"],audacityMin:2,text:"The path splits. Choose your burden for this round. Survive, and gain a reward of 3 points.",choices:[{label:"Veil",effect:{type:"ROUND_MODIFIER",modifier:"VEIL",flavorText:"A fog clouds your vision. The answers become indistinct shapes."}},{label:"Weight",effect:{type:"ROUND_MODIFIER",modifier:"WEIGHT",flavorText:"Every misstep feels heavier. The thread groans under the strain."}}],duration:"round",resolveAt:"endOfRound",reward:{type:"SCORE",value:3}},{id:"DYN004",title:"The Tallyman's Gambit",rarity:"Uncommon",tags:["Gamble","Consequence","Pact"],text:"You accept the Tallyman's Gambit. Each time you answer 'C' this round, a tally is marked. The final count will determine your fate.",choices:[{label:"Accept",effect:{type:"TALLY_TABLE",target:"C",table:{0:{type:"DOUBLE_ROUND_SCORE"}}}}],duration:"round",resolveAt:"endOfRound"},{id:"DYN005",title:"Scholar's Boon",rarity:"Common",tags:["Utility","Safety"],text:`Scholar's Boon: Your knowledge protects you.
Gain +1 Thread at the start of this round.`,choices:[{label:"Accept Boon",effect:{type:"POWER_UP",power:"REMOVE_WRONG_ANSWER",flavorText:"You feel a quiet confidence. One of the wrong paths fades from view, leaving only certainty and a single doubt."}},{label:"Turn it down",effect:{type:"SCORE",value:-1}}]}],Ui=Object.freeze(Object.defineProperty({__proto__:null,default:Et},Symbol.toStringTag,{value:"Module"})),Fi=Ee({type:Q()}).catchall(li()),Li=Ee({label:Q(),effect:Fi.optional()}),Wi=Ee({id:Q(),title:Q(),text:Q(),choices:Ie(Li).max(3)}),Mi=Ie(Wi),me=Mi.parse(Et);let U=null,ge=[],_e=0;function ji(){return U=me[Math.floor(Math.random()*me.length)],U}function Bi(){if(!U)return["","",""];const e=U.choices.map(t=>t.label||"");for(;e.length<3;)e.push("");return e.slice(0,3)}function qi(e){if(!U)return null;const t=U.choices[e];return t?.effect?(Yi(t.effect),U=null,t.effect?.flavorText||null):(U=null,null)}function Vi(e,t){let n=_e,o=0,r=1;return ge.forEach(i=>{if(i.type==="APPLY_WAGER"){const a=i.target.split("-").pop().toUpperCase(),c=e[a]||0;i.reward&&i.reward.type==="SCORE"&&(o+=i.reward.value*c)}else if(i.type==="TALLY_TABLE"){const a=e[i.target]||0;if(i.table&&i.table[a]){const c=i.table[a];c.type==="DOUBLE_ROUND_SCORE"?r*=2:c.type==="SCORE"&&(n+=c.value)}}}),ge=[],_e=0,{scoreDelta:n,roundScoreDelta:o,roundScoreMultiplier:r}}function Yi(e){e.type==="IMMEDIATE_SCORE"?_e+=e.value:e.type==="ADD_CARD_TO_DECK"&&e.card?me.push(e.card):ge.push(e)}typeof window<"u"&&(window.Fate={draw:ji,getButtonLabels:Bi,choose:qi,resolveRound:Vi});document.addEventListener("DOMContentLoaded",()=>{const e=document.getElementById("controller"),t=window.Fate||{};async function n(){await State.loadData(),await State.loadGame()?(UI.updateDisplayValues(State.getState()),UI.updateScreen(State.getState().currentScreen||"game-lobby")):(UI.updateScreen("welcome"),r()),console.log("[INIT]: Nous initialized.")}e.addEventListener("click",d=>{const v=d.target.closest("button")?.dataset.action;v&&a(v)});function o(d){(d.key==="ArrowUp"||d.key==="ArrowDown"||d.key==="Enter")&&d.preventDefault(),d.key==="ArrowUp"?a("welcome-up"):d.key==="ArrowDown"?a("welcome-down"):d.key==="Enter"&&a("welcome-select")}function r(){document.addEventListener("keydown",o)}function i(){document.removeEventListener("keydown",o)}window.addEventListener("beforeunload",()=>{State.saveGame()});function a(d){switch(console.log(`[ACTION]: ${d}`),State.getState(),d){case"welcome-up":UI.moveWelcomeSelection("up");break;case"welcome-down":UI.moveWelcomeSelection("down");break;case"welcome-select":{const _=UI.getWelcomeSelection();_==="Play"?a("start-game"):_==="Rules"?a("go-rules"):_==="Options"&&a("go-options");break}case"start-game":i(),UI.showParticipantEntry();break;case"participants-up":UI.adjustParticipantCount(1);break;case"participants-down":UI.adjustParticipantCount(-1);break;case"participants-confirm":{const _=UI.confirmParticipants();State.initializeGame(_),UI.updateDisplayValues(State.getState()),setTimeout(()=>{UI.updateScreen("game-lobby"),UI.updateDisplayValues(State.getState())},2e3);break}case"go-rules":UI.updateScreen("rules");break;case"go-options":UI.updateScreen("options");break;case"back-to-welcome":UI.updateScreen("welcome"),r();break;case"return-to-lobby":UI.updateScreen("game-lobby");break;case"restart-game":console.log("[ACTION]: Restarting game (placeholder)."),UI.updateScreen("welcome"),r();break;case"quit-game":console.log("[ACTION]: Quit game (placeholder).");break;case"save-reading":console.log("[ACTION]: Save reading (placeholder).");break;case"save-and-quit":State.saveGame(),UI.updateScreen("welcome"),r();break;case"tempt-fate":{const _=t.draw();if(!_)break;State.setCurrentFateCard(_),UI.showFateCard(_),UI.showFateChoices(t.getButtonLabels()),UI.updateScreen("fate-card");break}case"next-round":State.startNewRound(),UI.updateDisplayValues(State.getState()),UI.updateScreen("round-lobby");break;case"end-round":const f=State.cutThread();UI.updateDisplayValues(State.getState());let v="";if(typeof t.resolveRound=="function"){const _={A:0,B:0,C:0};State.getState().answeredThisRound.forEach(A=>{_[A.letter]=(_[A.letter]||0)+1});const b=t.resolveRound(_,f);State.applyFateResults(b),State.resetRound();const $=[];if(b.roundScoreMultiplier&&b.roundScoreMultiplier!==1&&$.push(`round score x${b.roundScoreMultiplier}`),b.roundScoreDelta){const A=b.roundScoreDelta>0?"+":"";$.push(`${A}${b.roundScoreDelta} round pts`)}if(b.scoreDelta){const A=b.scoreDelta>0?"+":"";$.push(`${A}${b.scoreDelta} score`)}v=$.length?`Fate resolves: ${$.join(", ")}`:""}UI.updateDisplayValues(State.getState()),f?UI.updateScreen("game-lobby"):(UI.showFailure(State.getState().roundScore),UI.updateScreen("failure")),v&&UI.showFateResult(v);break;case"double-points":State.spendThreadToWeave()?(State.shuffleNextCategory(),UI.updateDisplayValues(State.getState())):console.log("[ACTION]: Not enough Thread to weave.");break;case"start-question":State.pullThread(),UI.updateDisplayValues(State.getState());const h=State.getNextQuestion();h?(UI.showQuestion({title:h.title,text:h.text,choices:{A:h.answers[0].text,B:h.answers[1].text,C:h.answers[2].text}}),UI.updateScreen("question")):(alert("The thread has nothing left to reveal."),UI.updateScreen("round-lobby"));break;case"answer-a":case"answer-b":case"answer-c":const p=d.split("-")[1].toUpperCase();c(p);break;case"fate-a":case"fate-b":case"fate-c":{const _={"fate-a":0,"fate-b":1,"fate-c":2},b=State.chooseFateOption(_[d]);UI.showFateResult(b),UI.updateDisplayValues(State.getState()),UI.updateScreen("game-lobby");break}case"accept-result":UI.updateDisplayValues(State.getState()),State.getState().thread<=0?(UI.showFailure(State.getState().roundScore),State.endRound(!1),UI.updateScreen("failure")):UI.updateScreen("round-lobby");break;case"challenge-result":console.log("[ACTION]: Disagree triggered — increment Audacity (placeholder)."),UI.updateScreen("round-lobby");break}}function c(d){const f=State.getState().currentQuestion?.questionId;f&&State.recordAnswer(f,d);const v=State.evaluateAnswer(d);v&&(UI.showResult(v),UI.updateScreen("result"))}n(),window.handleAction=a});export{Ie as a,li as b,Qi as n,Ee as o,Q as s};
